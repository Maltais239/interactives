<html lang="en"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6ImE3ZTI3MWMzMmJkMTBkY2EwNTExOThmNjkwNjc3MGEzN2Q0MmRhM2IiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIxNTg2Mzk5NTkwNjU0MDIzMjkxNiIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjXzZlMGM3MGY1YmQ5MjBmMzVfaW5kZXguaHRtbC01MTUifSwiZXhwIjoxNzY4NTE2OTczLCJpYXQiOjE3Njg1MTMzNzMsImFsZyI6IlJTMjU2In0.gnfFxVJdBi6NEhf2yLxI9W2d210Cl5-dNnxGkqbUO4eOVymGEJeUONCWmtDNRPd7rzJfm7mvsGHZxXEPCIDwXqjMVfNd8qBV0bbz_tsj2jZiS97JsyFrlk9XBYbBgYb9CHnl-iJntmqYJ5OMOn691q4Eekg6YogsfbkjV_ZQJLoTHPJXbBKMMwafPRjIvnqFEvWhlgXg_3PhJpRj3z4pV3teyPYBDFfr3ifpiEnpuzb_FJupooJBJOn_vsy9jzAgyA3vL2B9gTpMn-7Xxvj2AeoTPo1k9hftxbvxeL3V8IFbUmvWOOHy2DqRCm0wAab53thRTbbmucc7WMLH4BOBLA","c_6e0c70f5bd920f35_index.html-515")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageTransformModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });
  modelInformation.deprecatedImageModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predict',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predictLongRunning',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash-preview-09-2025","imageModelName":"imagen-4.0-generate-001","imageEditModelName":"gemini-2.5-flash-image-preview","imageTransformModelName":"gemini-3-pro-image-preview-11-2025","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17","gemini-2.5-flash-preview-05-20"],"deprecatedImageModelNames":["imagen-3.0-generate-001","imagen-3.0-generate-002"]})</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vocabulary Arcade 1.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&amp;display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
            overflow: hidden;
        }
        body {
            font-family: 'Outfit', sans-serif;
            background-color: #f8fafc;
            background-image: radial-gradient(#e2e8f0 1px, transparent 1px);
            background-size: 32px 32px;
            touch-action: none;
            color: #1e293b;
        }
        
        /* Glassmorphism & UI Utils */
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        canvas {
            background-color: #ffffff;
            border-radius: 1rem;
            box-shadow: inset 0 2px 4px 0 rgb(0 0 0 / 0.05);
            cursor: grab;
            display: block;
            width: 100%;
            height: 100%;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
            transition: all 0.2s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }
        .btn-secondary {
            background: white;
            border: 1px solid #e2e8f0;
            color: #475569;
            transition: all 0.2s ease;
        }
        .btn-secondary:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
            transform: translateY(-2px);
        }

        .btn-xs {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            line-height: 1rem;
        }
        
        /* Animations */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-4px) rotate(-2deg); }
            40% { transform: translateX(4px) rotate(2deg); }
            60% { transform: translateX(-2px); }
            80% { transform: translateX(2px); }
        }
        .shake {
            animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
        }
        
        @keyframes popIn {
            0% { opacity: 0; transform: scale(0.9); }
            100% { opacity: 1; transform: scale(1); }
        }
        .card-pop {
            animation: popIn 0.3s ease-out forwards;
        }

        /* Swipe Game Animations */
        .swipe-right { transform: translateX(1000px) rotate(30deg) !important; opacity: 0; transition: all 0.5s ease; }
        .swipe-left { transform: translateX(-1000px) rotate(-30deg) !important; opacity: 0; transition: all 0.5s ease; }
        .swipe-card { transition: transform 0.1s linear; }

        /* Scramble Game Styles */
        .letter-tile { cursor: grab; touch-action: none; user-select: none; }
        .letter-tile:active { cursor: grabbing; transform: scale(1.1); }
        .drop-slot { transition: all 0.2s; }
        .drop-slot.over { background-color: #e0e7ff; border-color: #6366f1; transform: scale(1.05); }

        /* Flashcard Styles */
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        
        .flashcard-inner {
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        /* Corrected Selector: Target ID instead of class if element only has ID */
        #flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.pointer-events-none{pointer-events:none}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0px}.-bottom-6{bottom:-1.5rem}.bottom-4{bottom:1rem}.left-0{left:0px}.left-4{left:1rem}.right-4{right:1rem}.top-0{top:0px}.top-1\/2{top:50%}.top-4{top:1rem}.z-0{z-index:0}.z-10{z-index:10}.z-20{z-index:20}.z-50{z-index:50}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:0.25rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.mt-4{margin-top:1rem}.mt-8{margin-top:2rem}.mt-auto{margin-top:auto}.line-clamp-3{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3}.flex{display:flex}.grid{display:grid}.hidden{display:none}.aspect-\[3\/4\]{aspect-ratio:3/4}.h-10{height:2.5rem}.h-12{height:3rem}.h-16{height:4rem}.h-2\/5{height:40%}.h-3\/5{height:60%}.h-32{height:8rem}.h-4{height:1rem}.h-40{height:10rem}.h-5{height:1.25rem}.h-8{height:2rem}.h-96{height:24rem}.h-\[90\%\]{height:90%}.h-\[95\%\]{height:95%}.h-full{height:100%}.h-64{height:16rem}.max-h-full{max-height:100%}.min-h-\[80px\]{min-height:80px}.w-1{width:0.25rem}.w-10{width:2.5rem}.w-12{width:3rem}.w-16{width:4rem}.w-4{width:1rem}.w-5{width:1.25rem}.w-\[90\%\]{width:90%}.w-\[95\%\]{width:95%}.w-auto{width:auto}.w-full{width:100%}.max-w-2xl{max-width:42rem}.max-w-3xl{max-width:48rem}.max-w-6xl{max-width:72rem}.max-w-7xl{max-width:80rem}.max-w-full{max-width:100%}.max-w-md{max-width:28rem}.max-w-sm{max-width:24rem}.max-w-xs{max-width:20rem}.flex-1{flex:1 1 0%}.flex-shrink-0{flex-shrink:0}.flex-grow{flex-grow:1}.origin-center{transform-origin:center}.-translate-y-1\/2{--tw-translate-y:-50%;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-2{--tw-translate-y:0.5rem;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-4{--tw-translate-y:1rem;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-rotate-12{--tw-rotate:-12deg;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-rotate-90{--tw-rotate:-90deg;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-12{--tw-rotate:12deg;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-90{--tw-rotate:90deg;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-90{--tw-scale-x:.9;--tw-scale-y:.9;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-95{--tw-scale-x:.95;--tw-scale-y:.95;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite}.cursor-grab{cursor:grab}.cursor-pointer{cursor:pointer}.touch-none{touch-action:none}.resize-none{resize:none}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:0.25rem}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.whitespace-nowrap{white-space:nowrap}.rounded{border-radius:0.25rem}.rounded-2xl{border-radius:1rem}.rounded-3xl{border-radius:1.5rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.rounded-xl{border-radius:0.75rem}.border{border-width:1px}.border-2{border-width:2px}.border-4{border-width:4px}.border-t{border-top-width:1px}.border-green-100{--tw-border-opacity:1;border-color:rgb(220 252 231 / var(--tw-border-opacity, 1))}.border-green-500{--tw-border-opacity:1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.border-indigo-100{--tw-border-opacity:1;border-color:rgb(224 231 255 / var(--tw-border-opacity, 1))}.border-indigo-500{--tw-border-opacity:1;border-color:rgb(99 102 241 / var(--tw-border-opacity, 1))}.border-red-100{--tw-border-opacity:1;border-color:rgb(254 226 226 / var(--tw-border-opacity, 1))}.border-red-500{--tw-border-opacity:1;border-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.border-slate-100{--tw-border-opacity:1;border-color:rgb(241 245 249 / var(--tw-border-opacity, 1))}.border-slate-200{--tw-border-opacity:1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.border-slate-200\/60{border-color:rgb(226 232 240 / 0.6)}.border-slate-300{--tw-border-opacity:1;border-color:rgb(203 213 225 / var(--tw-border-opacity, 1))}.bg-blue-50{--tw-bg-opacity:1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-indigo-50{--tw-bg-opacity:1;background-color:rgb(238 242 255 / var(--tw-bg-opacity, 1))}.bg-indigo-500{--tw-bg-opacity:1;background-color:rgb(99 102 241 / var(--tw-bg-opacity, 1))}.bg-indigo-600{--tw-bg-opacity:1;background-color:rgb(79 70 229 / var(--tw-bg-opacity, 1))}.bg-orange-50{--tw-bg-opacity:1;background-color:rgb(255 247 237 / var(--tw-bg-opacity, 1))}.bg-pink-50{--tw-bg-opacity:1;background-color:rgb(253 242 248 / var(--tw-bg-opacity, 1))}.bg-red-100{--tw-bg-opacity:1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.bg-slate-200\/50{background-color:rgb(226 232 240 / 0.5)}.bg-slate-50{--tw-bg-opacity:1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}.bg-slate-900\/60{background-color:rgb(15 23 42 / 0.6)}.bg-teal-50{--tw-bg-opacity:1;background-color:rgb(240 253 250 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\/80{background-color:rgb(255 255 255 / 0.8)}.object-contain{object-fit:contain}.p-1{padding:0.25rem}.p-2{padding:0.5rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.px-1{padding-left:0.25rem;padding-right:0.25rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.pb-10{padding-bottom:2.5rem}.pb-4{padding-bottom:1rem}.pt-3{padding-top:0.75rem}.text-center{text-align:center}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-\[10px\]{font-size:10px}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-black{font-weight:900}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.leading-relaxed{line-height:1.625}.leading-tight{line-height:1.25}.tracking-tight{letter-spacing:-0.025em}.tracking-wider{letter-spacing:0.05em}.tracking-widest{letter-spacing:0.1em}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-emerald-500{--tw-text-opacity:1;color:rgb(16 185 129 / var(--tw-text-opacity, 1))}.text-green-200{--tw-text-opacity:1;color:rgb(187 247 208 / var(--tw-text-opacity, 1))}.text-green-300{--tw-text-opacity:1;color:rgb(134 239 172 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity:1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-indigo-200{--tw-text-opacity:1;color:rgb(199 210 254 / var(--tw-text-opacity, 1))}.text-indigo-500{--tw-text-opacity:1;color:rgb(99 102 241 / var(--tw-text-opacity, 1))}.text-indigo-600{--tw-text-opacity:1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.text-orange-600{--tw-text-opacity:1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.text-pink-600{--tw-text-opacity:1;color:rgb(219 39 119 / var(--tw-text-opacity, 1))}.text-red-200{--tw-text-opacity:1;color:rgb(254 202 202 / var(--tw-text-opacity, 1))}.text-red-300{--tw-text-opacity:1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-slate-300{--tw-text-opacity:1;color:rgb(203 213 225 / var(--tw-text-opacity, 1))}.text-slate-400{--tw-text-opacity:1;color:rgb(148 163 184 / var(--tw-text-opacity, 1))}.text-slate-500{--tw-text-opacity:1;color:rgb(100 116 139 / var(--tw-text-opacity, 1))}.text-slate-600{--tw-text-opacity:1;color:rgb(71 85 105 / var(--tw-text-opacity, 1))}.text-slate-700{--tw-text-opacity:1;color:rgb(51 65 85 / var(--tw-text-opacity, 1))}.text-slate-800{--tw-text-opacity:1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.text-slate-900{--tw-text-opacity:1;color:rgb(15 23 42 / var(--tw-text-opacity, 1))}.text-teal-600{--tw-text-opacity:1;color:rgb(13 148 136 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.placeholder-slate-300::placeholder{--tw-placeholder-opacity:1;color:rgb(203 213 225 / var(--tw-placeholder-opacity, 1))}.opacity-0{opacity:0}.opacity-50{opacity:0.5}.opacity-80{opacity:0.8}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-inner{--tw-shadow:inset 0 2px 4px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-indigo-100\/50{--tw-shadow-color:rgb(224 231 255 / 0.5);--tw-shadow:var(--tw-shadow-colored)}.shadow-indigo-200{--tw-shadow-color:#c7d2fe;--tw-shadow:var(--tw-shadow-colored)}.outline-none{outline:2px solid transparent;outline-offset:2px}.drop-shadow-md{--tw-drop-shadow:drop-shadow(0 4px 3px rgb(0 0 0 / 0.07)) drop-shadow(0 2px 2px rgb(0 0 0 / 0.06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-sm{--tw-drop-shadow:drop-shadow(0 1px 1px rgb(0 0 0 / 0.05));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur{--tw-backdrop-blur:blur(8px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-sm{--tw-backdrop-blur:blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-300{transition-duration:300ms}.duration-500{transition-duration:500ms}.hover\:scale-110:hover{--tw-scale-x:1.1;--tw-scale-y:1.1;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:bg-slate-50:hover{--tw-bg-opacity:1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}.hover\:text-slate-800:hover{--tw-text-opacity:1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.hover\:shadow-xl:hover{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.focus\:border-indigo-500:focus{--tw-border-opacity:1;border-color:rgb(99 102 241 / var(--tw-border-opacity, 1))}.focus\:text-slate-800:focus{--tw-text-opacity:1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-indigo-200:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(199 210 254 / var(--tw-ring-opacity, 1))}@media (min-width: 640px){.sm\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.sm\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}.sm\:p-6{padding:1.5rem}}@media (min-width: 768px){.md\:flex{display:flex}.md\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}.md\:grid-cols-4{grid-template-columns:repeat(4, minmax(0, 1fr))}.md\:text-2xl{font-size:1.5rem;line-height:2rem}}@media (min-width: 1024px){.lg\:grid-cols-5{grid-template-columns:repeat(5, minmax(0, 1fr))}}</style></head>
<body class="flex justify-center items-center p-4 sm:p-6">

    <div id="app-container" class="w-full h-full max-w-7xl mx-auto flex flex-col relative">
        
        <!-- App Header -->
        <header id="app-header" class="mb-6 flex-shrink-0 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center text-white text-xl shadow-lg shadow-indigo-200">
                    
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-slate-900 tracking-tight">Vocabulary Arcade 1.0</h1>
                    <p class="text-xs text-slate-500 font-medium uppercase tracking-wider">Import &amp; Play</p>
                </div>
            </div>
            
            <!-- Header Actions -->
            <div class="flex gap-3">
                <button id="import-json-btn" class="btn-secondary px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path></svg>
                    Import Set
                </button>
                <button id="download-html-btn" class="btn-secondary px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                    Download Arcade
                </button>
            </div>
        </header>

        <!-- Hidden File Input -->
        <input type="file" id="json-importer" class="hidden" accept=".json">

        <!-- Start Screen -->
        <section id="start-screen" class="flex-grow flex flex-col justify-center items-center relative z-10 overflow-y-auto">
            
            <div class="text-center mb-6 max-w-2xl flex-shrink-0">
                <h2 id="start-title" class="text-3xl font-bold text-slate-800 mb-2">Ready to Play?</h2>
                <p class="text-slate-500 text-lg">Import a JSON file or use the sample set.</p>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 w-full max-w-6xl pb-4">
                <!-- Game 1: Match -->
                <div class="group bg-white p-6 rounded-2xl shadow-sm hover:shadow-xl border border-slate-200 transition-all duration-300 flex flex-col items-center text-center">
                    <div class="w-12 h-12 bg-blue-50 text-blue-600 rounded-xl flex items-center justify-center text-2xl mb-3"></div>
                    <h3 class="text-lg font-bold text-slate-800">Match Master</h3>
                    <p class="text-slate-500 mb-4 text-xs leading-relaxed flex-grow">Drag definitions to their matching terms.</p>
                    <button id="start-match-game-btn" class="btn-primary text-white w-full py-2 rounded-lg font-bold text-sm mb-3">Play Match</button>
                    
                    <div class="w-full flex gap-2 border-t border-slate-100 pt-3 mt-auto">
                        <button onclick="exportGame('match', 'copy')" class="btn-secondary flex-1 py-1 text-xs rounded font-medium flex items-center justify-center gap-1 hover:bg-slate-50">
                             Copy HTML
                        </button>
                        <button onclick="exportGame('match', 'download')" class="btn-secondary flex-1 py-1 text-xs rounded font-medium flex items-center justify-center gap-1 hover:bg-slate-50">
                             Download
                        </button>
                    </div>
                </div>

                <!-- Game 2: Quiz -->
                <div class="group bg-white p-6 rounded-2xl shadow-sm hover:shadow-xl border border-slate-200 transition-all duration-300 flex flex-col items-center text-center">
                    <div class="w-12 h-12 bg-orange-50 text-orange-600 rounded-xl flex items-center justify-center text-2xl mb-3"></div>
                    <h3 class="text-lg font-bold text-slate-800">Speed Quiz</h3>
                    <p class="text-slate-500 mb-4 text-xs leading-relaxed flex-grow">Spot the correct card instantly.</p>
                    <button id="start-quiz-game-btn" class="btn-primary text-white w-full py-2 rounded-lg font-bold text-sm mb-3">Play Quiz</button>
                    
                     <div class="w-full flex gap-2 border-t border-slate-100 pt-3 mt-auto">
                        <button onclick="exportGame('quiz', 'copy')" class="btn-secondary flex-1 py-1 text-xs rounded font-medium flex items-center justify-center gap-1 hover:bg-slate-50">
                             Copy HTML
                        </button>
                        <button onclick="exportGame('quiz', 'download')" class="btn-secondary flex-1 py-1 text-xs rounded font-medium flex items-center justify-center gap-1 hover:bg-slate-50">
                             Download
                        </button>
                    </div>
                </div>

                <!-- Game 3: Swipe -->
                <div class="group bg-white p-6 rounded-2xl shadow-sm hover:shadow-xl border border-slate-200 transition-all duration-300 flex flex-col items-center text-center">
                    <div class="w-12 h-12 bg-pink-50 text-pink-600 rounded-xl flex items-center justify-center text-2xl mb-3"></div>
                    <h3 class="text-lg font-bold text-slate-800">Swipe Review</h3>
                    <p class="text-slate-500 mb-4 text-xs leading-relaxed flex-grow">Swipe Right if it matches, Left if it doesn't.</p>
                    <button id="start-swipe-game-btn" class="btn-primary text-white w-full py-2 rounded-lg font-bold text-sm mb-3">Play Swipe</button>
                    
                     <div class="w-full flex gap-2 border-t border-slate-100 pt-3 mt-auto">
                        <button onclick="exportGame('swipe', 'copy')" class="btn-secondary flex-1 py-1 text-xs rounded font-medium flex items-center justify-center gap-1 hover:bg-slate-50">
                             Copy HTML
                        </button>
                        <button onclick="exportGame('swipe', 'download')" class="btn-secondary flex-1 py-1 text-xs rounded font-medium flex items-center justify-center gap-1 hover:bg-slate-50">
                             Download
                        </button>
                    </div>
                </div>

                <!-- Game 4: Scramble -->
                <div class="group bg-white p-6 rounded-2xl shadow-sm hover:shadow-xl border border-slate-200 transition-all duration-300 flex flex-col items-center text-center">
                    <div class="w-12 h-12 bg-teal-50 text-teal-600 rounded-xl flex items-center justify-center text-2xl mb-3"></div>
                    <h3 class="text-lg font-bold text-slate-800">Word Scramble</h3>
                    <p class="text-slate-500 mb-4 text-xs leading-relaxed flex-grow">Type or Unscramble letters to spell.</p>
                    <button id="start-scramble-game-btn" class="btn-primary text-white w-full py-2 rounded-lg font-bold text-sm mb-3">Play Scramble</button>
                    
                     <div class="w-full flex gap-2 border-t border-slate-100 pt-3 mt-auto">
                        <button onclick="exportGame('scramble', 'copy')" class="btn-secondary flex-1 py-1 text-xs rounded font-medium flex items-center justify-center gap-1 hover:bg-slate-50">
                             Copy HTML
                        </button>
                        <button onclick="exportGame('scramble', 'download')" class="btn-secondary flex-1 py-1 text-xs rounded font-medium flex items-center justify-center gap-1 hover:bg-slate-50">
                             Download
                        </button>
                    </div>
                </div>

                <!-- Game 5: Flashcards -->
                <div class="group bg-white p-6 rounded-2xl shadow-sm hover:shadow-xl border border-slate-200 transition-all duration-300 flex flex-col items-center text-center">
                    <div class="w-12 h-12 bg-indigo-50 text-indigo-600 rounded-xl flex items-center justify-center text-2xl mb-3"></div>
                    <h3 class="text-lg font-bold text-slate-800">Flashcard Study</h3>
                    <p class="text-slate-500 mb-4 text-xs leading-relaxed flex-grow">Flip through cards to study terms.</p>
                    <button id="start-flashcard-game-btn" class="btn-primary text-white w-full py-2 rounded-lg font-bold text-sm mb-3">Start Study</button>
                    
                     <div class="w-full flex gap-2 border-t border-slate-100 pt-3 mt-auto">
                        <button onclick="exportGame('flashcard', 'copy')" class="btn-secondary flex-1 py-1 text-xs rounded font-medium flex items-center justify-center gap-1 hover:bg-slate-50">
                             Copy HTML
                        </button>
                        <button onclick="exportGame('flashcard', 'download')" class="btn-secondary flex-1 py-1 text-xs rounded font-medium flex items-center justify-center gap-1 hover:bg-slate-50">
                             Download
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- GAME 1: Match Game Container -->
        <main id="match-game-container" class="hidden w-full flex-grow flex flex-col items-center relative">
            <div class="w-full flex items-center justify-between mb-4 px-1 flex-shrink-0">
                <button class="main-menu-btn text-slate-500 hover:text-slate-800 font-semibold flex items-center gap-2 text-sm"> Exit</button>
                <div class="flex gap-4 bg-white px-4 py-2 rounded-full shadow-sm border border-slate-200 text-sm font-bold text-slate-600">
                    <span id="round-display" class="text-indigo-600">Round 1</span>
                    <span class="text-slate-300">|</span>
                    <span id="timer-display">0s</span>
                </div>
            </div>
            <div class="relative w-full flex-grow bg-slate-200/50 rounded-2xl border border-slate-200/60 p-1 shadow-inner overflow-hidden">
                <canvas id="game-canvas"></canvas>
            </div>
        </main>
        
        <!-- GAME 2: Quiz Game Container -->
        <main id="quiz-game-container" class="hidden w-full h-full flex-grow flex flex-col items-center relative">
            <div class="w-full flex items-center justify-between mb-4 px-1 flex-shrink-0">
                <button class="main-menu-btn text-slate-500 hover:text-slate-800 font-semibold flex items-center gap-2 text-sm"> Exit</button>
                <div class="text-sm font-bold text-slate-400 uppercase tracking-wider">Select the match</div>
            </div>
            <section id="hint-section" class="flex-shrink-0 w-full max-w-3xl bg-white border border-indigo-100 p-6 rounded-2xl shadow-lg shadow-indigo-100/50 text-center mb-6 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-1 h-full bg-indigo-500"></div>
                <p class="text-xs font-bold text-indigo-500 uppercase tracking-wider mb-2">Find this Term</p>
                <p id="hint-text" class="text-xl md:text-2xl font-bold text-slate-800">Click start to play!</p>
            </section>
            
            <!-- Card Grid -->
            <div id="card-container" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 w-full max-w-6xl flex-grow overflow-y-auto p-2 pb-4"></div>

            <!-- Word Bank -->
            <div class="w-full bg-white border-t border-slate-200 p-4 flex-shrink-0 z-10">
                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">Word Bank</p>
                <div id="quiz-word-bank" class="flex flex-wrap gap-2 justify-center">
                    <!-- Words injected here -->
                </div>
            </div>

            <!-- SUCCESS MODAL -->
            <div id="quiz-feedback-modal" class="absolute inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm hidden opacity-0 transition-opacity duration-300">
                <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-[90%] text-center transform scale-95 transition-transform duration-300 flex flex-col items-center" id="quiz-feedback-content">
                    <div class="mb-4 w-16 h-16 bg-green-100 rounded-full flex items-center justify-center text-green-600 text-3xl font-bold shadow-inner"></div>
                    <h3 class="text-3xl font-black text-slate-800 mb-2 leading-tight" id="feedback-term">Term</h3>
                    <p class="text-slate-500 mb-6 text-sm font-medium px-4" id="feedback-def">Definition</p>
                    <div class="h-40 w-full flex items-center justify-center bg-slate-50 rounded-xl p-4 mb-4 border border-slate-100 shadow-inner">
                        <img id="feedback-img" src="" class="max-h-full max-w-full object-contain drop-shadow-sm">
                    </div>
                    <p class="text-xs font-bold text-green-500 uppercase tracking-widest animate-pulse">Correct!</p>
                </div>
            </div>

            <!-- FAILURE MODAL -->
            <div id="quiz-failure-modal" class="absolute inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm hidden opacity-0 transition-opacity duration-300">
                <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-[90%] text-center transform scale-95 transition-transform duration-300 flex flex-col items-center" id="quiz-failure-content">
                    <div class="mb-4 w-16 h-16 bg-red-100 rounded-full flex items-center justify-center text-red-600 text-3xl font-bold shadow-inner"></div>
                    <h3 class="text-2xl font-bold text-slate-800 mb-1">No, that's a...</h3>
                    <h3 class="text-3xl font-black text-red-600 mb-4 leading-tight" id="fail-term">Term</h3>
                    <div class="h-40 w-full flex items-center justify-center bg-slate-50 rounded-xl p-4 mb-6 border border-slate-100 shadow-inner">
                        <img id="fail-img" src="" class="max-h-full max-w-full object-contain drop-shadow-sm">
                    </div>
                    <button onclick="quizGame.hideFailure()" class="btn-primary text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-indigo-200">Try Again</button>
                </div>
            </div>
        </main>

        <!-- GAME 3: Swipe Game Container -->
        <main id="swipe-game-container" class="hidden w-full h-full flex-grow flex flex-col items-center justify-center relative overflow-hidden">
             <div class="absolute top-4 left-4 z-20">
                <button class="main-menu-btn text-slate-500 hover:text-slate-800 font-semibold flex items-center gap-2 text-sm bg-white/80 backdrop-blur px-3 py-2 rounded-lg shadow-sm"> Exit</button>
            </div>
            
            <!-- Visual Cues -->
            <div class="absolute left-4 top-1/2 transform -translate-y-1/2 hidden md:flex flex-col items-center z-0 opacity-50">
                <div class="text-4xl font-black text-red-200 mb-2"></div>
                <div class="text-xs font-bold text-red-300 uppercase tracking-widest rotate-90 origin-center whitespace-nowrap">No Match &lt;</div>
            </div>
            <div class="absolute right-4 top-1/2 transform -translate-y-1/2 hidden md:flex flex-col items-center z-0 opacity-50">
                <div class="text-4xl font-black text-green-200 mb-2"></div>
                <div class="text-xs font-bold text-green-300 uppercase tracking-widest -rotate-90 origin-center whitespace-nowrap">&gt; Match</div>
            </div>

            <!-- Swipe Area -->
            <div class="relative w-full max-w-sm aspect-[3/4] flex flex-col items-center justify-center">
                <!-- Background Stack Effect -->
                <div class="absolute w-[90%] h-[90%] bg-white rounded-3xl border border-slate-200 shadow-sm transform scale-90 translate-y-4 opacity-50 z-0"></div>
                <div class="absolute w-[95%] h-[95%] bg-white rounded-3xl border border-slate-200 shadow-sm transform scale-95 translate-y-2 opacity-80 z-0"></div>
                
                <!-- Active Card -->
                <div id="swipe-card" class="swipe-card absolute w-full h-full bg-white rounded-3xl border border-slate-200 shadow-2xl flex flex-col overflow-hidden cursor-grab z-10 touch-none">
                    <!-- Image Area -->
                    <div class="h-3/5 bg-slate-50 flex items-center justify-center p-8 relative overflow-hidden">
                        <img id="swipe-img" src="" class="max-w-full max-h-full object-contain drop-shadow-md pointer-events-none">
                        <!-- Overlays -->
                        <div id="overlay-nope" class="absolute top-4 right-4 border-4 border-red-500 text-red-500 font-black text-2xl px-2 py-1 rounded opacity-0 transform rotate-12 pointer-events-none">NOPE</div>
                        <div id="overlay-like" class="absolute top-4 left-4 border-4 border-green-500 text-green-500 font-black text-2xl px-2 py-1 rounded opacity-0 transform -rotate-12 pointer-events-none">YES</div>
                    </div>
                    <!-- Text Area -->
                    <div class="h-2/5 p-6 flex flex-col items-center justify-center text-center">
                        <p class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">Is this...</p>
                        <h2 id="swipe-term" class="text-3xl font-bold text-slate-800 mb-2">Term</h2>
                        <p id="swipe-def" class="text-sm text-slate-500 line-clamp-3 hidden">Definition</p> 
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="mt-8 flex gap-6 z-20">
                <button id="btn-swipe-left" class="w-16 h-16 rounded-full bg-white text-red-500 shadow-lg flex items-center justify-center text-2xl hover:scale-110 transition-transform border border-red-100 relative">
                    
                    <span class="absolute -bottom-6 text-[10px] font-bold text-slate-300 uppercase">No</span>
                </button>
                <button id="btn-swipe-right" class="w-16 h-16 rounded-full bg-white text-green-500 shadow-lg flex items-center justify-center text-2xl hover:scale-110 transition-transform border border-green-100 relative">
                    
                    <span class="absolute -bottom-6 text-[10px] font-bold text-slate-300 uppercase">Match</span>
                </button>
            </div>
            
            <div class="mt-4 text-slate-400 text-sm font-medium">Use Arrow Keys or Swipe</div>
        </main>

        <!-- GAME 4: Scramble Game Container -->
        <main id="scramble-game-container" class="hidden w-full h-full flex-grow flex flex-col items-center relative overflow-y-auto">
            <div class="w-full flex items-center justify-between mb-4 px-1 flex-shrink-0">
                <button class="main-menu-btn text-slate-500 hover:text-slate-800 font-semibold flex items-center gap-2 text-sm"> Exit</button>
                <div id="scramble-score" class="text-indigo-600 font-bold text-lg">Score: 0</div>
            </div>

            <div class="flex-grow flex flex-col items-center justify-center w-full max-w-2xl pb-10">
                <!-- Clue Section -->
                <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-100 w-full flex flex-col items-center mb-8">
                    <img id="scramble-img" src="" class="h-32 w-auto object-contain mb-4 drop-shadow-sm">
                    <p id="scramble-def" class="text-slate-600 text-center font-medium">Definition goes here...</p>
                </div>

                <!-- Slots -->
                <div id="word-slots" class="flex flex-wrap justify-center gap-2 mb-8">
                    <!-- Slots injected via JS -->
                </div>

                <!-- Input Field -->
                <div class="w-full max-w-xs mb-8">
                    <input type="text" id="scramble-input" class="w-full text-center px-4 py-3 rounded-xl border-2 border-indigo-100 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none text-slate-700 font-bold uppercase tracking-widest placeholder-slate-300" placeholder="TYPE ANSWER HERE">
                </div>

                <!-- Letter Tiles -->
                <div id="letter-bank" class="flex flex-wrap justify-center gap-3 p-4 bg-slate-200/50 rounded-2xl min-h-[80px] w-full">
                    <!-- Tiles injected via JS -->
                </div>
                
                <div id="scramble-message" class="h-8 mt-4 text-lg font-bold text-emerald-500"></div>
                <button id="scramble-next-btn" class="mt-4 btn-primary text-white px-6 py-2 rounded-lg hidden">Next Word </button>
            </div>
        </main>

        <!-- GAME 5: Flashcard Study Container -->
        <main id="flashcard-game-container" class="hidden w-full h-full flex-grow flex flex-col items-center relative overflow-y-auto">
            <div class="w-full flex items-center justify-between mb-4 px-1 flex-shrink-0">
                <button class="main-menu-btn text-slate-500 hover:text-slate-800 font-semibold flex items-center gap-2 text-sm"> Exit</button>
                <div class="text-sm font-bold text-slate-400 uppercase tracking-wider" id="flashcard-counter">Card 1 of 10</div>
            </div>

            <div class="flex-grow flex flex-col items-center justify-center w-full h-full pb-10 px-4">
                <!-- Flashcard with Class -->
                <div id="flashcard" class="flashcard group perspective-1000 w-full max-w-md h-96 cursor-pointer mb-8 relative">
                    <div class="flashcard-inner relative w-full h-full transition-all duration-500 transform-style-3d shadow-xl rounded-2xl">
                        <!-- Front -->
                        <div class="absolute w-full h-full backface-hidden bg-white rounded-2xl p-8 flex flex-col items-center justify-center border border-slate-200">
                            <div class="flex-grow flex items-center justify-center mb-4 w-full h-3/5">
                                <img id="fc-front-img" src="" class="max-w-full max-h-full object-contain drop-shadow-sm">
                            </div>
                            <h2 id="fc-front-term" class="text-3xl font-bold text-slate-800 text-center">Term</h2>
                            <p class="absolute bottom-4 text-xs font-bold text-slate-400 uppercase tracking-widest">Click to Flip</p>
                        </div>
                        <!-- Back -->
                        <div class="absolute w-full h-full backface-hidden rotate-y-180 bg-indigo-600 rounded-2xl p-8 flex flex-col items-center justify-center text-white border border-indigo-500">
                            <p class="text-xs font-bold text-indigo-200 uppercase tracking-widest mb-4">Definition</p>
                            <p id="fc-back-def" class="text-xl font-medium text-center leading-relaxed">Definition goes here.</p>
                        </div>
                    </div>
                </div>

                <!-- Controls -->
                <div class="flex gap-6 items-center">
                    <button id="fc-prev-btn" class="btn-secondary w-12 h-12 rounded-full flex items-center justify-center text-xl shadow-md"></button>
                    <button id="fc-flip-btn" class="btn-primary text-white px-8 py-3 rounded-full font-bold shadow-lg flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                        Flip
                    </button>
                    <button id="fc-next-btn" class="btn-secondary w-12 h-12 rounded-full flex items-center justify-center text-xl shadow-md"></button>
                </div>
            </div>
        </main>

    </div>

    <script>
        // --- General UI Elements ---
        const appContainer = document.getElementById('app-container');
        const startScreen = document.getElementById('start-screen');
        const startTitle = document.getElementById('start-title');
        const importJsonButton = document.getElementById('import-json-btn');
        const downloadHtmlButton = document.getElementById('download-html-btn');
        const jsonImporter = document.getElementById('json-importer');
        
        // --- DATA & STATE ---
        // 
        /* DATA_START */
        const DEFAULT_MATCH_VOCAB = [{"term":"Apple","definition":"A red or green fruit","imageSrc":"https://img.icons8.com/color/96/apple.png"},{"term":"Car","definition":"A vehicle with 4 wheels","imageSrc":"https://img.icons8.com/color/96/car.png"},{"term":"Sun","definition":"Star at center of solar system","imageSrc":"https://img.icons8.com/color/96/sun.png"},{"term":"Book","definition":"Pages with stories or info","imageSrc":"https://img.icons8.com/color/96/book.png"},{"term":"Tree","definition":"Tall plant with trunk","imageSrc":"https://img.icons8.com/color/96/tree.png"},{"term":"Dog","definition":"Loyal pet, barks","imageSrc":"https://img.icons8.com/color/96/dog.png"},{"term":"Computer","definition":"Electronic device for data","imageSrc":"https://img.icons8.com/color/96/computer.png"},{"term":"Music","definition":"Sounds combined in harmony","imageSrc":"https://img.icons8.com/color/96/musical-notes.png"}];
        /* DATA_END */
            

        let MASTER_VOCABULARY = JSON.parse(JSON.stringify(DEFAULT_MATCH_VOCAB));
        let IS_CUSTOM_SET_LOADED = false;

        // --- NAVIGATION ---
        const containers = {
            start: document.getElementById('start-screen'),
            match: document.getElementById('match-game-container'),
            quiz: document.getElementById('quiz-game-container'),
            swipe: document.getElementById('swipe-game-container'),
            scramble: document.getElementById('scramble-game-container'),
            flashcard: document.getElementById('flashcard-game-container')
        };

        function showStartScreen() {
            Object.values(containers).forEach(c => c.classList.add('hidden'));
            containers.start.classList.remove('hidden');
            document.getElementById('app-header').classList.remove('hidden');
        }

        function startGame(type) {
            // Hide Header for immersion
            document.getElementById('app-header').classList.add('hidden');
            
            // Hide all containers
            Object.values(containers).forEach(c => c.classList.add('hidden'));
            
            // Show selected container
            containers[type].classList.remove('hidden');
            
            // Initialize specific game
            if (type === 'match') matchGame.init();
            if (type === 'quiz') quizGame.init();
            if (type === 'swipe') swipeGame.init();
            if (type === 'scramble') scrambleGame.init();
            if (type === 'flashcard') flashcardGame.init();
        }

        // --- EVENT LISTENERS ---
        document.getElementById('start-match-game-btn').onclick = () => startGame('match');
        document.getElementById('start-quiz-game-btn').onclick = () => startGame('quiz');
        document.getElementById('start-swipe-game-btn').onclick = () => startGame('swipe');
        document.getElementById('start-scramble-game-btn').onclick = () => startGame('scramble');
        document.getElementById('start-flashcard-game-btn').onclick = () => startGame('flashcard');

        document.querySelectorAll('.main-menu-btn').forEach(btn => {
            btn.onclick = showStartScreen;
        });

        // --- Import / Export ---
        importJsonButton.addEventListener('click', () => jsonImporter.click());
        jsonImporter.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const importedData = JSON.parse(e.target.result);
                    const standardizedData = importedData.map(item => ({...item, imageSrc: item.imageSrc || item.image }));
                    if (!Array.isArray(standardizedData) || standardizedData.some(item => !item.term || !item.definition)) throw new Error("Invalid JSON");
                    MASTER_VOCABULARY = standardizedData;
                    IS_CUSTOM_SET_LOADED = true;
                    startTitle.innerHTML = `<span class="text-green-600">Success!</span> Loaded ${MASTER_VOCABULARY.length} Cards.`;
                } catch (error) {
                    startTitle.innerHTML = `<span class="text-red-500">Error:</span> ${error.message}`;
                }
            };
            reader.readAsText(file);
        });

        const getSelfContainedHtml = (autoStartGame = null) => {
            const vocabToSave = IS_CUSTOM_SET_LOADED ? MASTER_VOCABULARY : DEFAULT_MATCH_VOCAB;
            
            const cleanVocab = vocabToSave.map(item => ({
                term: item.term,
                definition: item.definition,
                imageSrc: item.imageSrc || item.image 
            }));
            
            const newScriptData = `
        /* DATA_START */
        const DEFAULT_MATCH_VOCAB = ${JSON.stringify(cleanVocab)};
        /* DATA_END */
            `;
            
            let html = document.documentElement.outerHTML;

            // Robust replacement
            const startMarker = "/* DATA_START */";
            const endMarker = "/* DATA_END */";
            const startIndex = html.indexOf(startMarker);
            const endIndex = html.indexOf(endMarker);

            if (startIndex !== -1 && endIndex !== -1) {
                const before = html.substring(0, startIndex);
                const after = html.substring(endIndex + endMarker.length);
                html = before + newScriptData + after;
            } else {
                 const script = `const DEFAULT_MATCH_VOCAB = ${JSON.stringify(cleanVocab)};\n        MASTER_VOCABULARY = DEFAULT_MATCH_VOCAB; IS_CUSTOM_SET_LOADED = true;`;
                 html = html.replace(
                    /const DEFAULT_MATCH_VOCAB = \[[\s\S]*?\];/, 
                    script
                );
            }

            // If we are exporting a specific game, inject the startup script
            if (autoStartGame) {
                const autoStartScript = `<script>window.onload = function() { startGame('${autoStartGame}'); };<\/script>`;
                html = html.replace('<script>window.onload = function() { startGame('match'); };</script></body>', `${autoStartScript}</body>`);
            }

            return html;
        };

        // UI Helper for Copy Fallback
        const showManualCopyModal = (text) => {
            const modal = document.createElement('div');
            modal.style.position = 'fixed';
            modal.style.inset = '0';
            modal.style.zIndex = '10000';
            modal.style.backgroundColor = 'rgba(15, 23, 42, 0.95)';
            modal.style.display = 'flex';
            modal.style.flexDirection = 'column';
            modal.style.alignItems = 'center';
            modal.style.justifyContent = 'center';
            modal.style.padding = '20px';

            const container = document.createElement('div');
            container.className = 'bg-white rounded-xl shadow-2xl p-6 w-full max-w-2xl flex flex-col gap-4';
            container.style.maxHeight = '80vh';

            const header = document.createElement('h3');
            header.className = 'text-xl font-bold text-slate-800 flex items-center gap-2';
            header.innerHTML = '<span class="text-2xl"></span> Copy Code';
            
            const hint = document.createElement('p');
            hint.className = 'text-slate-500 text-sm';
            hint.innerHTML = 'The file is ready. <strong class="text-indigo-600">Press Ctrl+C (or Cmd+C)</strong> now to copy it.';

            const textArea = document.createElement('textarea');
            textArea.className = 'w-full h-64 p-4 border border-slate-300 rounded-lg font-mono text-xs bg-slate-50 text-slate-400 focus:text-slate-800 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none resize-none';
            textArea.value = text;
            textArea.readOnly = true;

            const footer = document.createElement('div');
            footer.className = "flex justify-end";

            const closeBtn = document.createElement('button');
            closeBtn.className = 'btn-primary px-6 py-2 rounded-lg font-bold text-white shadow-lg shadow-indigo-200';
            closeBtn.innerText = 'Done';
            closeBtn.onclick = () => document.body.removeChild(modal);

            footer.appendChild(closeBtn);
            container.appendChild(header);
            container.appendChild(hint);
            container.appendChild(textArea);
            container.appendChild(footer);
            modal.appendChild(container);
            document.body.appendChild(modal);

            textArea.focus();
            textArea.select();
        };

        // Helper to export specific games
        window.exportGame = function(gameType, action) {
             // 1. Generate HTML (with auto-start for this game type)
            const fullHtml = getSelfContainedHtml(gameType);

            if (action === 'download') {
                const blob = new Blob([fullHtml], { type: 'text/html' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = `${gameType}-game.html`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else if (action === 'copy') {
                // FORCE the manual modal. It is the only reliable way for 30MB+ files.
                // Browsers will crash if we try to execCommand on this much text.
                showManualCopyModal(fullHtml);
            }
        };

        downloadHtmlButton.addEventListener('click', () => {
             // Default "Download Arcade" (whole thing, menu start)
            const fullHtml = getSelfContainedHtml(null);
            const blob = new Blob([fullHtml], { type: 'text/html' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'vocabulary-arcade.html';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });


        /*********************************************************
         * GAME 1: MATCH MASTER (High DPI Fixed)
         *********************************************************/
        const matchGame = {
            canvas: document.getElementById('game-canvas'),
            ctx: document.getElementById('game-canvas').getContext('2d'),
            gameObjects: [], images: {}, draggedObject: null, 
            timerInterval: null, secondsElapsed: 0, currentRound: 0,
            CARD_WIDTH: 200, CARD_HEIGHT: 150, PADDING: 20,
            logicalWidth: 0, logicalHeight: 0,
            
            init: function() {
                this.workingVocabulary = JSON.parse(JSON.stringify(MASTER_VOCABULARY));
                this.currentRound = 0;

                // High DPI Scaling
                const rect = this.canvas.parentElement.getBoundingClientRect();
                this.logicalWidth = rect.width;
                this.logicalHeight = rect.height;
                const dpr = window.devicePixelRatio || 1;
                this.canvas.width = this.logicalWidth * dpr;
                this.canvas.height = this.logicalHeight * dpr;
                this.canvas.style.width = `${this.logicalWidth}px`;
                this.canvas.style.height = `${this.logicalHeight}px`;
                this.ctx.scale(dpr, dpr);
                
                this.startRound();
                
                // Bind Events - Robust Touch Support
                const canvas = this.canvas;
                
                // Clean up any old listeners
                canvas.onmousedown = null;
                canvas.onmousemove = null;
                canvas.onmouseup = null;
                canvas.ontouchstart = null;
                canvas.ontouchmove = null;
                canvas.ontouchend = null;

                // Mouse Listeners
                canvas.addEventListener('mousedown', (e) => this.onDown(e));
                canvas.addEventListener('mousemove', (e) => this.onMove(e));
                window.addEventListener('mouseup', (e) => this.onUp(e)); // Catch release outside canvas

                // Touch Listeners (Passive: false prevents scrolling)
                canvas.addEventListener('touchstart', (e) => this.onDown(e), { passive: false });
                canvas.addEventListener('touchmove', (e) => this.onMove(e), { passive: false });
                window.addEventListener('touchend', (e) => this.onUp(e));
            },
            
            startRound: function() {
                this.currentRound++;
                const roundSize = Math.min(6, this.workingVocabulary.length);
                if (roundSize === 0) return showStartScreen(); 
                
                const vocab = this.workingVocabulary.splice(0, roundSize);
                document.getElementById('round-display').textContent = `Round ${this.currentRound}`;
                this.secondsElapsed = 0;
                
                let loaded = 0;
                if (vocab.length === 0) return;
                vocab.forEach(item => {
                    const img = new Image();
                    img.src = item.imageSrc;
                    img.onload = img.onerror = () => {
                        this.images[item.term] = img;
                        if (++loaded === vocab.length) this.setupObjects(vocab);
                    };
                });
            },
            
            setupObjects: function(vocab) {
                this.gameObjects = [];
                let placed = [];
                const create = (item, type) => {
                    let obj, overlap, attempts = 0;
                    do {
                        // Use logicalWidth/Height for placement calculations
                        obj = {
                            term: item.term, type: type, content: type === 'term' ? item.term : item.definition,
                            x: this.PADDING + Math.random() * (this.logicalWidth - this.CARD_WIDTH - 40),
                            y: this.PADDING + Math.random() * (this.logicalHeight - this.CARD_HEIGHT - 40),
                            width: this.CARD_WIDTH, height: this.CARD_HEIGHT, isMatched: false
                        };
                        overlap = placed.some(p => this.isOverlapping(obj, p));
                    } while(overlap && attempts++ < 50);
                    placed.push(obj);
                    return obj;
                };
                vocab.forEach(item => {
                    this.gameObjects.push(create(item, 'term'), create(item, 'definition'));
                });
                
                if (this.timerInterval) clearInterval(this.timerInterval);
                this.timerInterval = setInterval(() => {
                    document.getElementById('timer-display').textContent = `${++this.secondsElapsed}s`;
                }, 1000);
                this.draw();
            },
            
            draw: function() {
                this.ctx.clearRect(0, 0, this.logicalWidth + 100, this.logicalHeight + 100);
                this.gameObjects.forEach(o => !o.isMatched && this.drawCard(o, true));
                this.gameObjects.forEach(o => !o.isMatched && o !== this.draggedObject && this.drawCard(o));
                if (this.draggedObject) this.drawCard(this.draggedObject);
            },
            
            drawCard: function(obj, shadow = false) {
                const ctx = this.ctx;
                if (shadow) {
                    ctx.fillStyle = 'rgba(0,0,0,0.1)';
                    ctx.beginPath(); ctx.roundRect(obj.x, obj.y + 4, obj.width, obj.height, 16); ctx.fill();
                    return;
                }
                ctx.fillStyle = obj.type === 'term' ? '#f8fafc' : '#fff7ed';
                ctx.strokeStyle = obj.type === 'term' ? '#e2e8f0' : '#fed7aa';
                ctx.lineWidth = 2;
                ctx.beginPath(); ctx.roundRect(obj.x, obj.y, obj.width, obj.height, 16); ctx.fill(); ctx.stroke();
                
                ctx.fillStyle = '#1e293b';
                ctx.textAlign = 'center';
                if (obj.type === 'term') {
                    const img = this.images[obj.term];
                    // SAFETY CHECK: Only draw if image exists, is fully loaded, and has width
                    if (img && img.complete && img.naturalWidth > 0) {
                        const scale = Math.min((obj.width-30)/img.width, (obj.height-60)/img.height);
                        const w = img.width*scale, h = img.height*scale;
                        ctx.drawImage(img, Math.floor(obj.x + (obj.width-w)/2), Math.floor(obj.y+20), Math.floor(w), Math.floor(h));
                    }
                    ctx.fillStyle = '#6366f1';
                    ctx.font = 'bold 16px Outfit';
                    this.wrapText(ctx, obj.content, obj.x+obj.width/2, obj.y+obj.height-20, obj.width-20, 20);
                } else {
                    ctx.fillStyle = '#ea580c';
                    ctx.font = '500 14px Outfit';
                    this.wrapText(ctx, obj.content, obj.x+obj.width/2, obj.y+obj.height/2, obj.width-20, 20);
                }
            },
            
            onDown: function(e) {
                if (e.cancelable) e.preventDefault(); // Prevent scrolling on touch
                const rect = this.canvas.getBoundingClientRect();
                const x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
                const y = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;
                
                for (let i = this.gameObjects.length - 1; i >= 0; i--) {
                    const o = this.gameObjects[i];
                    if (!o.isMatched && x > o.x && x < o.x + o.width && y > o.y && y < o.y + o.height) {
                        this.draggedObject = o;
                        this.dragOffset = { x: x - o.x, y: y - o.y };
                        // Move to top of stack
                        this.gameObjects.push(this.gameObjects.splice(i, 1)[0]);
                        this.draw(); // Instant feedback
                        return;
                    }
                }
            },
            
            onMove: function(e) {
                if (!this.draggedObject) return;
                if (e.cancelable) e.preventDefault();
                
                const rect = this.canvas.getBoundingClientRect();
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                
                const x = clientX - rect.left;
                const y = clientY - rect.top;
                
                this.draggedObject.x = x - this.dragOffset.x;
                this.draggedObject.y = y - this.dragOffset.y;
                this.draw();
            },
            
            onUp: function(e) {
                if (!this.draggedObject) return;
                
                // Check collisions
                const target = this.gameObjects.find(o => 
                    o !== this.draggedObject && 
                    !o.isMatched && 
                    o.term === this.draggedObject.term && 
                    this.isOverlapping(this.draggedObject, o)
                );

                if (target) {
                    this.draggedObject.isMatched = true;
                    target.isMatched = true;
                    
                    // Snap to target for neatness
                    this.draggedObject.x = target.x + 10;
                    this.draggedObject.y = target.y + 10;
                }
                
                this.draggedObject = null;
                this.draw();
                
                if (this.gameObjects.every(o => o.isMatched)) {
                    clearInterval(this.timerInterval);
                    setTimeout(() => this.startRound(), 1000);
                }
            },
            
            isOverlapping: function(r1, r2) {
                return r1.x < r2.x + r2.width - 20 && r1.x + r1.width > r2.x + 20 && r1.y < r2.y + r2.height - 20 && r1.y + r1.height > r2.y + 20;
            },
            
            wrapText: function(ctx, text, x, y, maxW, lineH) {
                const words = text.split(' ');
                let line = '', lines = [];
                for(let n = 0; n < words.length; n++) {
                    let test = line + words[n] + ' ';
                    if(ctx.measureText(test).width > maxW && n > 0) { lines.push(line); line = words[n] + ' '; }
                    else { line = test; }
                }
                lines.push(line);
                let startY = y - (lines.length * lineH)/2 + lineH/2;
                lines.forEach((l, i) => ctx.fillText(l, x, startY + i*lineH));
            }
        };


        /*********************************************************
         * GAME 2: SPEED QUIZ (With Success/Failure Modals)
         *********************************************************/
        const quizGame = {
            container: document.getElementById('card-container'),
            hintText: document.getElementById('hint-text'),
            wordBank: document.getElementById('quiz-word-bank'),
            modal: document.getElementById('quiz-feedback-modal'),
            modalContent: document.getElementById('quiz-feedback-content'),
            failModal: document.getElementById('quiz-failure-modal'),
            failContent: document.getElementById('quiz-failure-content'),
            feedbackTerm: document.getElementById('feedback-term'),
            feedbackDef: document.getElementById('feedback-def'),
            feedbackImg: document.getElementById('feedback-img'),
            failTerm: document.getElementById('fail-term'),
            failImg: document.getElementById('fail-img'),
            colors: ['bg-rose-50', 'bg-orange-50', 'bg-amber-50', 'bg-emerald-50', 'bg-teal-50', 'bg-cyan-50', 'bg-indigo-50'],
            
            init: function() {
                this.cards = [...MASTER_VOCABULARY].sort(() => Math.random() - 0.5);
                this.index = 0;
                this.renderCards();
                this.renderWordBank();
                this.nextHint();
            },
            
            nextHint: function() {
                if (this.index >= this.cards.length) {
                    this.hintText.textContent = " Completed! ";
                    setTimeout(showStartScreen, 2000);
                    return;
                }
                this.hintText.textContent = this.cards[this.index].definition;
            },
            
            renderCards: function() {
                this.container.innerHTML = '';
                const displayCards = [...this.cards].sort(() => Math.random() - 0.5);
                displayCards.forEach((card, i) => {
                    const el = document.createElement('div');
                    el.className = `card-pop h-48 ${this.colors[i % 7]} rounded-xl border-2 border-slate-200 shadow-sm hover:shadow-md cursor-pointer relative overflow-hidden flex flex-col`;
                    el.innerHTML = `
                        <div class="flex-1 p-4 flex items-center justify-center"><img src="${card.imageSrc}" class="max-h-full max-w-full object-contain drop-shadow-sm"></div>
                        <div class="h-12 bg-white/80 flex items-center justify-center px-2 border-t border-slate-100"><h2 class="text-sm font-bold text-slate-800 text-center leading-snug">${card.term}</h2></div>
                        <div class="absolute inset-0 bg-emerald-500/90 flex items-center justify-center opacity-0 transition-opacity is-correct"><span class="text-white text-4xl font-bold"></span></div>
                    `;
                    el.onclick = () => this.check(el, card);
                    this.container.appendChild(el);
                });
            },

            renderWordBank: function() {
                this.wordBank.innerHTML = '';
                const sortedTerms = [...this.cards].sort((a,b) => a.term.localeCompare(b.term));
                sortedTerms.forEach(card => {
                    const chip = document.createElement('div');
                    chip.id = `bank-term-${card.term.replace(/\s/g, '-')}`;
                    chip.className = "px-3 py-1 bg-slate-100 text-slate-600 rounded-full text-xs font-bold border border-slate-200 transition-all";
                    chip.textContent = card.term;
                    this.wordBank.appendChild(chip);
                });
            },
            
            check: function(el, card) {
                if (el.classList.contains('pointer-events-none')) return;
                
                if (card.term === this.cards[this.index].term) {
                    // Correct
                    el.querySelector('.is-correct').classList.remove('opacity-0');
                    el.classList.add('pointer-events-none');
                    
                    const bankChip = document.getElementById(`bank-term-${card.term.replace(/\s/g, '-')}`);
                    if (bankChip) {
                        bankChip.classList.remove('bg-slate-100', 'text-slate-600', 'border-slate-200');
                        bankChip.classList.add('bg-green-100', 'text-green-700', 'border-green-300', 'ring-2', 'ring-green-200');
                        bankChip.innerHTML = ` ${card.term}`;
                    }

                    this.showFeedback(card);
                    this.index++;
                } else {
                    // Incorrect
                    el.classList.add('shake', 'border-red-400');
                    setTimeout(() => el.classList.remove('shake', 'border-red-400'), 500);
                    this.showFailure(card);
                }
            },

            showFeedback: function(card) {
                this.feedbackTerm.textContent = card.term;
                this.feedbackDef.textContent = card.definition;
                this.feedbackImg.src = card.imageSrc;
                this.modal.classList.remove('hidden');
                setTimeout(() => { this.modal.classList.remove('opacity-0'); this.modalContent.classList.add('scale-100'); }, 10);
                setTimeout(() => { this.modal.classList.add('opacity-0'); this.modalContent.classList.remove('scale-100'); setTimeout(() => { this.modal.classList.add('hidden'); this.nextHint(); }, 300); }, 2000);
            },

            showFailure: function(card) {
                this.failTerm.textContent = card.term;
                this.failImg.src = card.imageSrc;
                this.failModal.classList.remove('hidden');
                setTimeout(() => { this.failModal.classList.remove('opacity-0'); this.failContent.classList.add('scale-100'); }, 10);
            },

            hideFailure: function() {
                this.failModal.classList.add('opacity-0');
                this.failContent.classList.remove('scale-100');
                setTimeout(() => { this.failModal.classList.add('hidden'); }, 300);
            }
        };


        /*********************************************************
         * GAME 3: SWIPE REVIEW (New!)
         *********************************************************/
        const swipeGame = {
            cardEl: document.getElementById('swipe-card'),
            imgEl: document.getElementById('swipe-img'),
            termEl: document.getElementById('swipe-term'),
            defEl: document.getElementById('swipe-def'),
            likeOverlay: document.getElementById('overlay-like'),
            nopeOverlay: document.getElementById('overlay-nope'),
            
            queue: [],
            currentPair: null,
            isDragging: false,
            startX: 0,

            init: function() {
                this.queue = [];
                const deck = [...MASTER_VOCABULARY];
                
                // Phase 1: GUARANTEED Correct Matches (Review Every Term)
                deck.forEach(item => {
                    this.queue.push({
                        imageSrc: item.imageSrc,
                        term: item.term,
                        isMatch: true,
                        correctTerm: item.term
                    });
                });

                // Phase 2: Add Distractors (Incorrect Matches)
                // We add distractors equal to 60% of the deck size to keep it unpredictable
                const distractorCount = Math.ceil(deck.length * 0.6);
                for(let i = 0; i < distractorCount; i++) {
                    const correct = deck[i % deck.length];
                    let wrong;
                    // Find a wrong term (ensure we don't accidentally pick the same one)
                    let attempts = 0;
                    do { 
                        wrong = deck[Math.floor(Math.random() * deck.length)]; 
                        attempts++;
                    } while (wrong.term === correct.term && attempts < 10);
                    
                    this.queue.push({
                        imageSrc: correct.imageSrc, // Show correct image
                        term: wrong.term,           // But wrong label
                        isMatch: false,
                        correctTerm: correct.term
                    });
                }

                // Shuffle the entire queue so matches and mismatches are mixed
                this.queue.sort(() => Math.random() - 0.5);

                this.loadCard();
                this.bindEvents();
            },

            loadCard: function() {
                if (this.queue.length === 0) {
                    this.termEl.textContent = "Run Complete!";
                    this.imgEl.src = "";
                    setTimeout(showStartScreen, 2000);
                    return;
                }
                // Queue behaves as a stack here (pop from end)
                this.currentPair = this.queue.pop();
                this.imgEl.src = this.currentPair.imageSrc;
                this.termEl.textContent = this.currentPair.term;
                this.defEl.textContent = ""; 
                
                this.cardEl.style.transform = '';
                this.cardEl.style.transition = 'none';
                this.likeOverlay.style.opacity = 0;
                this.nopeOverlay.style.opacity = 0;
            },

            handleSwipe: function(direction) { 
                this.cardEl.classList.add(direction === 'right' ? 'swipe-right' : 'swipe-left');
                
                const userSaidYes = direction === 'right';
                const isCorrect = (userSaidYes && this.currentPair.isMatch) || (!userSaidYes && !this.currentPair.isMatch);
                
                document.body.style.backgroundColor = isCorrect ? '#dcfce7' : '#fee2e2'; 
                setTimeout(() => document.body.style.backgroundColor = '#f8fafc', 300);

                setTimeout(() => {
                    this.cardEl.classList.remove('swipe-right', 'swipe-left');
                    this.loadCard();
                }, 300);
            },

            bindEvents: function() {
                const card = this.cardEl;
                const start = (x) => { this.isDragging = true; this.startX = x; card.style.transition = 'none'; };
                const move = (x) => {
                    if (!this.isDragging) return;
                    const delta = x - this.startX;
                    const rotate = delta * 0.1;
                    card.style.transform = `translateX(${delta}px) rotate(${rotate}deg)`;
                    
                    this.likeOverlay.style.opacity = delta > 0 ? Math.min(delta/100, 1) : 0;
                    this.nopeOverlay.style.opacity = delta < 0 ? Math.min(Math.abs(delta)/100, 1) : 0;
                };
                const end = (x) => {
                    if (!this.isDragging) return;
                    this.isDragging = false;
                    const delta = x - this.startX;
                    if (delta > 100) this.handleSwipe('right');
                    else if (delta < -100) this.handleSwipe('left');
                    else {
                        card.style.transition = 'transform 0.3s ease';
                        card.style.transform = '';
                        this.likeOverlay.style.opacity = 0;
                        this.nopeOverlay.style.opacity = 0;
                    }
                };

                card.onmousedown = e => start(e.clientX);
                document.onmousemove = e => move(e.clientX);
                document.onmouseup = e => end(e.clientX);

                card.ontouchstart = e => start(e.touches[0].clientX);
                document.ontouchmove = e => move(e.touches[0].clientX);
                document.ontouchend = e => end(e.changedTouches[0].clientX);

                document.getElementById('btn-swipe-left').onclick = () => this.handleSwipe('left');
                document.getElementById('btn-swipe-right').onclick = () => this.handleSwipe('right');

                document.onkeydown = (e) => {
                    if (containers.swipe.classList.contains('hidden')) return;
                    if (e.key === 'ArrowLeft') this.handleSwipe('left');
                    if (e.key === 'ArrowRight') this.handleSwipe('right');
                };
            }
        };


        /*********************************************************
         * GAME 4: WORD SCRAMBLE (Typing Added + Auto-Advance)
         *********************************************************/
        const scrambleGame = {
            imgEl: document.getElementById('scramble-img'),
            defEl: document.getElementById('scramble-def'),
            slotsContainer: document.getElementById('word-slots'),
            bankContainer: document.getElementById('letter-bank'),
            msgEl: document.getElementById('scramble-message'),
            nextBtn: document.getElementById('scramble-next-btn'),
            scoreEl: document.getElementById('scramble-score'),
            inputEl: document.getElementById('scramble-input'),
            
            words: [], index: 0, score: 0, draggedLetter: null,

            init: function() {
                this.words = [...MASTER_VOCABULARY].sort(() => Math.random() - 0.5);
                this.index = 0;
                this.score = 0;
                this.scoreEl.textContent = "Score: 0";
                this.nextBtn.onclick = () => this.loadWord();
                this.inputEl.addEventListener('input', (e) => this.handleTyping(e));
                this.loadWord();
            },

            loadWord: function() {
                if (this.index >= this.words.length) {
                    this.msgEl.textContent = "All words solved!";
                    setTimeout(showStartScreen, 2000);
                    return;
                }
                
                const current = this.words[this.index];
                const cleanWord = current.term.replace(/[^a-zA-Z]/g, '').toUpperCase();
                
                this.imgEl.src = current.imageSrc;
                this.defEl.textContent = current.definition;
                this.msgEl.textContent = "";
                this.nextBtn.classList.add('hidden');
                this.slotsContainer.innerHTML = '';
                this.bankContainer.innerHTML = '';
                this.inputEl.disabled = false; // Re-enable input
                this.inputEl.value = '';
                this.inputEl.focus();
                
                for (let i = 0; i < cleanWord.length; i++) {
                    const slot = document.createElement('div');
                    slot.className = "w-10 h-12 border-b-4 border-slate-300 flex items-center justify-center text-2xl font-bold text-slate-700 bg-white rounded-t-md drop-slot";
                    slot.dataset.index = i;
                    
                    slot.ondragover = e => { e.preventDefault(); slot.classList.add('over'); };
                    slot.ondragleave = () => slot.classList.remove('over');
                    slot.ondrop = e => this.handleDrop(e, slot);
                    slot.onclick = () => this.handleSlotClick(slot);
                    
                    this.slotsContainer.appendChild(slot);
                }

                const letters = cleanWord.split('').map((l, i) => ({ char: l, id: i }));
                letters.sort(() => Math.random() - 0.5);
                
                letters.forEach(l => {
                    const tile = document.createElement('div');
                    tile.className = "w-10 h-10 bg-indigo-600 text-white rounded-lg shadow-md flex items-center justify-center font-bold text-xl letter-tile hover:scale-110 transition-transform";
                    tile.draggable = true;
                    tile.textContent = l.char;
                    tile.id = `tile-${l.id}`;
                    
                    tile.ondragstart = e => { 
                        this.draggedLetter = tile; 
                        e.dataTransfer.setData('text/plain', tile.id);
                    };
                    tile.onclick = () => this.autoPlace(tile);
                    
                    this.bankContainer.appendChild(tile);
                });
            },

            handleTyping: function(e) {
                const val = e.target.value.toUpperCase();
                const slots = Array.from(this.slotsContainer.children);
                
                // Basic 2-way bind: update slots visually
                slots.forEach((slot, i) => {
                    if (val[i]) {
                        // Find a matching tile in bank if possible, else create phantom
                        // Simplest logic: Just set text
                        slot.textContent = val[i];
                        slot.classList.add('border-indigo-400');
                    } else {
                        slot.textContent = '';
                        slot.classList.remove('border-indigo-400');
                    }
                });

                const currentWord = this.words[this.index].term.replace(/[^a-zA-Z]/g, '').toUpperCase();
                if (val === currentWord) {
                    this.win();
                }
            },

            handleDrop: function(e, slot) {
                e.preventDefault();
                slot.classList.remove('over');
                const tileId = e.dataTransfer.getData('text/plain');
                const tile = document.getElementById(tileId);
                this.placeTile(tile, slot);
            },

            autoPlace: function(tile) {
                const emptySlot = Array.from(this.slotsContainer.children).find(s => !s.hasChildNodes());
                if (emptySlot) this.placeTile(tile, emptySlot);
            },
            
            handleSlotClick: function(slot) {
                if (slot.hasChildNodes() && slot.firstChild.nodeType === 1) { // Is Element
                    const tile = slot.firstChild;
                    this.bankContainer.appendChild(tile); 
                    this.syncInput();
                }
            },

            placeTile: function(tile, slot) {
                if (slot.hasChildNodes()) return; 
                slot.appendChild(tile);
                this.syncInput();
                this.checkWin();
            },

            syncInput: function() {
               // Update input box based on tiles
               const slots = Array.from(this.slotsContainer.children);
               const text = slots.map(s => s.textContent).join('');
               this.inputEl.value = text;
            },

            checkWin: function() {
                const currentWord = this.words[this.index].term.replace(/[^a-zA-Z]/g, '').toUpperCase();
                const slots = Array.from(this.slotsContainer.children);
                if (slots.some(s => !s.textContent)) return; // Incomplete

                const spelled = slots.map(s => s.textContent).join('');
                if (spelled === currentWord) {
                    this.win();
                } else {
                    this.msgEl.textContent = "Try again...";
                    this.slotsContainer.classList.add('shake');
                    setTimeout(() => this.slotsContainer.classList.remove('shake'), 500);
                }
            },

            win: function() {
                this.msgEl.textContent = "Correct! ";
                this.score += 10;
                this.scoreEl.textContent = `Score: ${this.score}`;
                this.slotsContainer.childNodes.forEach(s => s.classList.add('bg-green-100', 'border-green-500'));
                this.inputEl.value = ''; 
                this.inputEl.disabled = true; // Disable input during transition
                this.index++;
                
                // Auto-advance after 1.5 seconds
                setTimeout(() => {
                    this.loadWord();
                }, 1500);
            }
        };

        /*********************************************************
         * GAME 5: FLASHCARD STUDY MODE
         *********************************************************/
        const flashcardGame = {
            container: document.getElementById('flashcard-game-container'),
            cardEl: null, // Will set in init
            frontImg: null,
            frontTerm: null,
            backDef: null,
            counter: null,
            
            cards: [],
            index: 0,
            isFlipped: false,

            init: function() {
                // Re-fetch elements FRESH to ensure no stale references if DOM updated
                this.cardEl = document.getElementById('flashcard');
                this.frontImg = document.getElementById('fc-front-img');
                this.frontTerm = document.getElementById('fc-front-term');
                this.backDef = document.getElementById('fc-back-def');
                this.counter = document.getElementById('flashcard-counter');

                this.cards = [...MASTER_VOCABULARY];
                this.index = 0;
                this.isFlipped = false;
                this.renderCard();
                this.bindEvents();
            },

            renderCard: function() {
                const card = this.cards[this.index];
                this.frontImg.src = card.imageSrc;
                this.frontTerm.textContent = card.term;
                this.backDef.textContent = card.definition;
                this.counter.textContent = `Card ${this.index + 1} of ${this.cards.length}`;
                
                // Reset flip state
                this.isFlipped = false;
                this.cardEl.classList.remove('flipped');
            },

            flipCard: function() {
                this.isFlipped = !this.isFlipped;
                this.cardEl.classList.toggle('flipped');
            },

            nextCard: function() {
                if (this.index < this.cards.length - 1) {
                    this.index++;
                    this.renderCard();
                }
            },

            prevCard: function() {
                if (this.index > 0) {
                    this.index--;
                    this.renderCard();
                }
            },

            bindEvents: function() {
                // Assign directly. If called multiple times, it just overwrites.
                this.cardEl.onclick = (e) => {
                    // Prevent bubbling if clicking inner interactive elements (though none here)
                    this.flipCard();
                };
                document.getElementById('fc-flip-btn').onclick = () => this.flipCard();
                document.getElementById('fc-next-btn').onclick = () => this.nextCard();
                document.getElementById('fc-prev-btn').onclick = () => this.prevCard();

                // Keyboard Nav
                document.onkeydown = (e) => {
                    if (containers.flashcard.classList.contains('hidden')) return;
                    if (e.key === 'ArrowRight') this.nextCard();
                    if (e.key === 'ArrowLeft') this.prevCard();
                    if (e.key === ' ' || e.key === 'Enter') this.flipCard();
                };
            }
        };

    </script>

</body></html>
