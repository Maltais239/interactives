
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alberta's Boundaries</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f0fdf4; /* Light green background */
            color: #1f2937; /* Dark gray text */
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 700px;
            text-align: left;
        }
        h1 {
            color: #15803d; /* Dark green for heading */
            margin-bottom: 5px;
            font-size: 1.8rem;
            text-align: center;
        }
        h2 {
            color: #166534; /* Medium green for subheading */
            margin-bottom: 20px;
            font-size: 1.1rem;
            text-align: center;
            font-weight: normal;
        }
        .paragraph-text p {
            margin-bottom: 1.5em; 
            line-height: 1.7; 
        }
        .text-chunk { display: inline; }
        .clickable-chunk {
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease, padding 0.3s ease;
            padding: 2px 3px; 
            border-radius: 4px; 
            margin: 0 1px; 
        }
        .clickable-chunk:hover { background-color: #dcfce7; }
        .clickable-chunk.selected-key {
            background-color: #86efac; 
            color: #14532d;
            font-weight: 600;
            box-shadow: 0 0 5px rgba(20, 83, 45, 0.3);
        }
        .clickable-chunk.selected-other {
            background-color: #cffafe; 
            color: #0e7490;
        }
        .feedback {
            margin-top: 20px;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 48px; /* Ensure space for content */
        }
        .feedback.good {
            background-color: #dcfce7;
            color: #16a34a;
        }
        .reset-button, .continue-button, .quiz-submit-button {
            background-color: #15803d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease, transform 0.1s ease;
        }
        .reset-button:hover, .continue-button:hover, .quiz-submit-button:hover {
            background-color: #166534;
            transform: translateY(-1px);
        }
        .quiz-container {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px dashed #a7f3d0;
        }
        .quiz-question {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #d1fae5;
            border-radius: 8px;
            background-color: #f0fdf4;
        }
        .quiz-question p {
            font-weight: 600;
            margin-bottom: 10px;
            color: #065f46;
        }
        .quiz-option label {
            display: block;
            background-color: #ecfdf5;
            padding: 10px;
            margin-top: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
            border: 1px solid #a7f3d0;
        }
        .quiz-option input[type="radio"] {
            margin-right: 10px;
            accent-color: #15803d;
        }
        .quiz-option label:hover {
            background-color: #dcfce7;
        }
        .quiz-result {
            padding: 8px 12px;
            border-radius: 6px;
            font-weight: 600;
            margin-top: 5px;
            font-size: 0.9em;
        }
        .quiz-result.correct {
            background-color: #dcfce7;
            color: #16a34a;
        }
        .quiz-result.incorrect {
            background-color: #fee2e2;
            color: #ef4444;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Alberta's Boundaries</h1>
        <h2>Goal: Click only on the most important VOCABULARY TERMS in the passage.</h2>

        <div id="textContent" class="paragraph-text">
            <!-- Content injected here by JS -->
        </div>

        <div id="feedbackArea" class="feedback" role="status">
            <span id="feedbackText">Found <span id="foundCount">0</span> of <span id="totalKeyCount">0</span> key vocabulary terms.</span>
        </div>

        <div id="quizSection" class="quiz-container hidden">
            <h3 class="text-xl font-semibold text-center text-green-700 mb-6">Comprehension Check</h3>
            <div id="quizContent">
                <!-- Quiz questions injected here -->
            </div>
            <button id="quizSubmitButton" class="quiz-submit-button w-full mt-6">Check My Answers</button>
            <div id="quizScore" class="feedback mt-4 hidden"></div>
        </div>
        
        <button id="resetButton" class="reset-button w-full">Start Over</button>
    </div>

    <script>
        // --- UTILITY FUNCTION FOR RANDOMIZATION ---
        /**
         * Shuffles array in place (Fisher-Yates algorithm).
         * @param {Array} array Array to shuffle.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- QUIZ DATA (Combined 8 questions) ---
        const quizQuestions = [
            // User's Latest Set (Fact Retrieval)
            {
                id: 1,
                question: "Before 1905, Alberta was part of the:",
                options: ["United States", "Northwest Territories", "Rocky Mountains", "Yukon Territory"],
                answer: "Northwest Territories",
            },
            {
                id: 2,
                question: "Political boundaries are made by:",
                options: ["Nature", "People", "Animals", "Rivers"],
                answer: "People",
            },
            {
                id: 3,
                question: "The Rocky Mountains are an example of a:",
                options: ["Political boundary", "Physical boundary", "City", "Straight line boundary"],
                answer: "Physical boundary",
            },
            {
                id: 4,
                question: "Alberta’s eastern border is shared with:",
                options: ["British Columbia", "Saskatchewan", "Ontario", "Manitoba"],
                answer: "Saskatchewan",
            },
            // Previous Set (Vocabulary Identification)
            {
                id: 5,
                question: "The term for a large, self-governing area within a country, like Alberta, is a:",
                options: ["District", "Territory", "Province", "Region"],
                answer: "Province",
            },
            {
                id: 6,
                question: "What is the general name for the lines that mark where one area of land ends and another begins?",
                options: ["Rivers", "Lines of Latitude", "Borders", "Highways"],
                answer: "Borders",
            },
            {
                id: 7,
                question: "Which type of boundary is made by people and separates political areas, like countries or provinces?",
                options: ["Natural Boundaries", "Physical boundaries", "Straight Boundaries", "Political boundaries"],
                answer: "Political boundaries",
            },
            {
                id: 8,
                question: "The Rocky Mountains are an example of what kind of boundary?",
                options: ["Political boundaries", "Physical boundaries", "Imaginary boundaries", "Town limits"],
                answer: "Physical boundaries",
            },
        ];

        // --- VOCABULARY SPOTLIGHT TEXT ---
        const structuredText = [
            // Introduction Paragraphs
            [
                { text: "In 1905, something important happened in Canadian history—Alberta became a ", isClickable: false },
                { text: "province", isClickable: true, isKey: true },
                { text: "! Before 1905, the land that is now Alberta was part of a much larger area called the Northwest Territories. The Canadian government decided to divide that land and create two new provinces: Alberta and Saskatchewan." }
            ],
            // Drawing the Borders Paragraph
            [
                { text: "When Alberta became a province, the government had to decide where the ", isClickable: false },
                { text: "borders", isClickable: true, isKey: true },
                { text: " would be. These borders were chosen to make the land easy to govern and develop. Some borders were straight lines created by people, and others followed natural features like rivers and mountains." }
            ],
            // Political Boundaries Section
            [
                { text: "Political boundaries are lines on a map that show where one area ends and another begins. These are known as ", isClickable: false },
                { text: "Political boundaries", isClickable: true, isKey: true },
                { text: ". They are made by people. Alberta’s political boundaries separate us from: British Columbia, Saskatchewan, and the Northwest Territories." }
            ],
            // Physical Boundaries Section
            [
                { text: "Natural features that divide land are called ", isClickable: false },
                { text: "Physical boundaries", isClickable: true, isKey: true },
                { text: ". They are made by nature, not people. In Alberta: The Rocky Mountains form a physical boundary along the western edge of the province. The Athabasca River is another important natural feature." }
            ],
            // Conclusion Paragraph
            [
                { text: "Both political and physical boundaries help us understand how Alberta is connected to the rest of Canada and to the natural world around us." }
            ]
        ];

        const keyInformationText = structuredText.flatMap(paragraph => 
            paragraph.filter(chunk => chunk.isKey).map(chunk => chunk.text)
        );

        const textContentDiv = document.getElementById('textContent');
        const feedbackArea = document.getElementById('feedbackArea');
        const feedbackTextSpan = document.getElementById('feedbackText');
        const totalKeyCountSpan = document.getElementById('totalKeyCount');
        const quizSection = document.getElementById('quizSection');
        const quizContent = document.getElementById('quizContent');
        const quizSubmitButton = document.getElementById('quizSubmitButton');
        const quizScoreDiv = document.getElementById('quizScore');
        const resetButton = document.getElementById('resetButton');

        let foundKeyInfoCount = 0;
        let isQuizDisplayed = false;

        function initializeActivity() {
            textContentDiv.innerHTML = ''; 
            foundKeyInfoCount = 0;
            totalKeyCountSpan.textContent = keyInformationText.length;
            
            // Reset Quiz UI
            quizSection.classList.add('hidden');
            quizContent.innerHTML = '';
            quizScoreDiv.classList.add('hidden');
            isQuizDisplayed = false;

            // Render Text/Highlighting
            structuredText.forEach(paragraphChunks => {
                const pElement = document.createElement('p');
                paragraphChunks.forEach(chunk => {
                    const span = document.createElement('span');
                    span.textContent = chunk.text;
                    span.classList.add('text-chunk');

                    if (chunk.isClickable) {
                        span.classList.add('clickable-chunk');
                        span.dataset.text = chunk.text;
                        span.setAttribute('role', 'button');
                        span.setAttribute('tabindex', '0');

                        if (chunk.isKey) {
                            span.dataset.isKey = "true";
                        }

                        span.addEventListener('click', handleChunkClick);
                        span.addEventListener('keydown', (event) => {
                            if (event.key === 'Enter' || event.key === ' ') {
                                handleChunkClick(event);
                            }
                        });
                    }
                    pElement.appendChild(span);
                });
                textContentDiv.appendChild(pElement);
            });
            updateFeedback();
        }

        function handleChunkClick(event) {
            const clickedSpan = event.currentTarget;
            if (isQuizDisplayed) return; // Prevent highlighting during the quiz

            const isKey = clickedSpan.dataset.isKey === "true";

            if (clickedSpan.classList.contains('selected-key') || clickedSpan.classList.contains('selected-other')) {
                // Deselecting
                if (clickedSpan.classList.contains('selected-key')) {
                    foundKeyInfoCount--;
                }
                clickedSpan.classList.remove('selected-key', 'selected-other');
            } else {
                // Selecting
                if (isKey) {
                    if (!clickedSpan.classList.contains('selected-key')) {
                         clickedSpan.classList.add('selected-key');
                         foundKeyInfoCount++;
                    }
                } else {
                    clickedSpan.classList.add('selected-other');
                }
            }
            updateFeedback();
        }

        function updateFeedback() {
            // Update the count text
            feedbackTextSpan.innerHTML = `Found <span id="foundCount">${foundKeyInfoCount}</span> of <span id="totalKeyCount">${keyInformationText.length}</span> key vocabulary terms.`;
            
            // Check for completion
            if (foundKeyInfoCount === keyInformationText.length) {
                feedbackArea.classList.add('good');
                feedbackArea.innerHTML = `
                    <span class="flex-1 text-left">Great job! You highlighted all the key terms.</span>
                    <button id="continueButton" class="continue-button ml-4">Continue to Quiz</button>
                `;
                document.getElementById('continueButton').addEventListener('click', displayQuiz);
            } else {
                feedbackArea.classList.remove('good');
                feedbackArea.innerHTML = `<span id="feedbackText">Found <span id="foundCount">${foundKeyInfoCount}</span> of <span id="totalKeyCount">${keyInformationText.length}</span> key vocabulary terms.</span>`;
            }
        }

        function displayQuiz() {
            isQuizDisplayed = true;
            textContentDiv.classList.add('hidden');
            feedbackArea.classList.add('hidden');
            quizSection.classList.remove('hidden');

            // Hide the reset button temporarily in the quiz
            resetButton.classList.add('hidden'); 

            // SHUFFLE QUESTIONS BEFORE DISPLAYING THEM
            const shuffledQuestions = shuffleArray([...quizQuestions]);

            quizContent.innerHTML = '';
            shuffledQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'quiz-question';
                questionDiv.innerHTML = `<p>${index + 1}. ${q.question}</p>`;
                
                // Note: The answer options are NOT shuffled
                q.options.forEach(option => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'quiz-option';
                    optionDiv.innerHTML = `
                        <label>
                            <input type="radio" name="question_${q.id}" value="${option}">
                            ${option}
                        </label>
                    `;
                    questionDiv.appendChild(optionDiv);
                });
                quizContent.appendChild(questionDiv);
            });
        }

        function checkQuizAnswers() {
            let correctAnswers = 0;
            // We iterate over the original quizQuestions array, but check the radio buttons
            // by their unique 'name' attribute which uses the question 'id'.
            quizQuestions.forEach(q => {
                const selectedOption = document.querySelector(`input[name="question_${q.id}"]:checked`);
                const questionDiv = document.querySelector(`input[name="question_${q.id}"]`).closest('.quiz-question'); // Find parent
                
                // Clear previous feedback
                questionDiv.querySelectorAll('.quiz-result').forEach(el => el.remove());

                if (selectedOption) {
                    const isCorrect = selectedOption.value === q.answer;
                    const resultSpan = document.createElement('div');
                    
                    if (isCorrect) {
                        correctAnswers++;
                        resultSpan.textContent = "Correct!";
                        resultSpan.className = "quiz-result correct";
                    } else {
                        resultSpan.textContent = `Incorrect. The correct answer is: ${q.answer}`;
                        resultSpan.className = "quiz-result incorrect";
                    }
                    questionDiv.appendChild(resultSpan);
                } else {
                    // Handle unselected case 
                    const resultSpan = document.createElement('div');
                    resultSpan.textContent = `Please select an answer. Correct: ${q.answer}`;
                    resultSpan.className = "quiz-result incorrect";
                    questionDiv.appendChild(resultSpan);
                }
            });

            // Display final score
            quizScoreDiv.classList.remove('hidden');
            quizScoreDiv.classList.remove('good');
            quizScoreDiv.innerHTML = `You scored ${correctAnswers} out of ${quizQuestions.length}.`;
            if (correctAnswers === quizQuestions.length) {
                quizScoreDiv.classList.add('good');
                quizScoreDiv.innerHTML = `Perfect Score! You got ${correctAnswers}/${quizQuestions.length} correct!`;
            }

            // Restore the reset button
            resetButton.classList.remove('hidden');
        }

        quizSubmitButton.addEventListener('click', checkQuizAnswers);
        resetButton.addEventListener('click', () => {
             // Reloads the entire activity from the start state
             textContentDiv.classList.remove('hidden');
             feedbackArea.classList.remove('hidden');
             initializeActivity();
        });

        // Initial setup
        document.addEventListener('DOMContentLoaded', initializeActivity);
    </script>
</body>
</html>


