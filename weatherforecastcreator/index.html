<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weather Dashboard - Student Input</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- Kept for potential future re-addition, though chart is currently removed -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #6B46C1 0%, #3B82F6 100%);
      min-height: 100vh;
      overflow-y: scroll; 
    }
    .glass {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }
    .weather-icon { 
      width: 70px; 
      height: 70px;
    }
    .forecast-icon { 
        width: 40px; 
        height: 40px; 
    }
    .forecast-card {
        transition: all 0.3s ease;
        display: flex; 
        flex-direction: column;
        justify-content: space-between;
    }
    .forecast-card:hover {
      transform: translateY(-5px);
    }
    .forecast-card-hazard { 
        border: 2px solid #F59E0B; 
        background: rgba(245, 158, 11, 0.05); 
    }
    select {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%233B82F6%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.4-5.4-12.8z%22%2F%3E%3C%2Fsvg%3E');
      background-repeat: no-repeat;
      background-position: right .7em top 50%;
      background-size: .65em auto;
      padding-right: 2.5em; 
    }
    .input-field {
        background-color: rgba(255, 255, 255, 0.8);
        color: #374151; 
    }
    .input-field::placeholder {
        color: #6b7280; 
    }
    .number-input-condensed {
        width: 100%; /* Full width on very small screens */
    }
    @media (min-width: 400px) { 
        .number-input-condensed {
            width: 7rem; /* Adjusted for slightly more space if needed */
        }
    }
    @media (min-width: 640px) { /* sm breakpoint */
      .number-input-condensed {
        width: 6rem; 
      }
    }
    .text-input-responsive {
        width: 100%;
    }
    .weather-desc-select { /* Specific class for weather description select */
        min-width: 12rem; /* Ensure it has a decent minimum width */
        width: 100%; /* Default to full width */
    }
    @media (min-width: 640px) { /* sm breakpoint */
        .weather-desc-select {
             width: auto; /* Allow it to shrink or grow based on content */
             max-width: 18rem; /* But don't let it get too wide */
        }
    }


    .toggle-form-btn-style {
        background-color: #8B5CF6; 
        color: white;
        padding: 0.25rem 0.75rem; 
        font-size: 0.8rem;    
        border-radius: 0.375rem; 
        font-weight: 500; 
        transition: background-color 0.2s;
    }
    .toggle-form-btn-style:hover {
        background-color: #7C3AED; 
    }
    .warning-section {
        background-color: rgba(255, 235, 59, 0.1); 
        border: 1px solid #FACC15; 
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 1.5rem;
        color: #CA8A04; 
    }
    .warning-item {
        display: flex;
        align-items: center;
        padding: 0.5rem;
        border-bottom: 1px solid rgba(202, 138, 4, 0.2);
    }
    .warning-item:last-child {
        border-bottom: none;
    }
    .warning-icon {
        width: 24px;
        height: 24px;
        margin-right: 0.75rem;
        fill: currentColor;
    }
  </style>
</head>
<body class="p-4 md:p-8">
  <!-- Form Container -->
  <div class="max-w-5xl mx-auto mb-8"> 
    <div class="text-center mb-4">
        <button type="button" id="toggle-form-btn" class="toggle-form-btn-style">Hide Input Form</button>
    </div>
    <h1 class="text-3xl md:text-4xl font-bold text-white text-center mb-6">Weather Dashboard - Student Input</h1>
    <form id="data-form" class="glass p-6 space-y-4"> <!-- Reduced overall space-y -->
      
      <!-- Section Title: Location & Conditions -->
      <h2 class="text-xl font-semibold text-white border-b border-white/30 pb-2">Location & Current Conditions</h2>
      <!-- Row 1: Place Name & Country -->
      <div class="flex flex-wrap gap-x-6 gap-y-4 items-end">
        <div class="flex-auto min-w-[10rem] sm:min-w-[12rem]"> <!-- Place name can take more space -->
          <label for="input-city" class="block text-white font-semibold mb-1 text-sm">Place Name</label>
          <input type="text" id="input-city" class="input-field text-input-responsive px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="e.g., Edmonton" value="Sherwood Park">
        </div>
        <div> <!-- Country can be more compact -->
          <label for="input-country" class="block text-white font-semibold mb-1 text-sm">Country</label>
          <input type="text" id="input-country" class="input-field number-input-condensed px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="e.g., CA" value="CA">
        </div>
      </div>
      <!-- Row 2: Temperatures -->
      <div class="flex flex-wrap gap-x-6 gap-y-4 items-end mt-3"> <!-- Reduced mt -->
        <div>
          <label for="input-temp" class="block text-white font-semibold mb-1 text-sm">Temp (°C)</label>
          <input type="number" id="input-temp" class="input-field number-input-condensed px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="15" value="18">
        </div>
        <div>
          <label for="input-temp-high" class="block text-white font-semibold mb-1 text-sm">High (°C)</label>
          <input type="number" id="input-temp-high" class="input-field number-input-condensed px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="18" value="20">
        </div>
        <div>
          <label for="input-temp-low" class="block text-white font-semibold mb-1 text-sm">Low (°C)</label>
          <input type="number" id="input-temp-low" class="input-field number-input-condensed px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="10" value="9">
        </div>
         <div>
          <label for="input-feels" class="block text-white font-semibold mb-1 text-sm">Feels Like (°C)</label>
          <input type="number" id="input-feels" class="input-field number-input-condensed px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="13" value="17">
        </div>
      </div>
      <!-- Row 3: Description & Other Conditions -->
      <div class="flex flex-wrap gap-x-6 gap-y-4 items-end mt-3"> <!-- Reduced mt -->
        <div class="flex-grow md:flex-grow-0"> <!-- Allow description to take reasonable space -->
          <label for="input-weather-desc" class="block text-white font-semibold mb-1 text-sm">Description</label>
          <select id="input-weather-desc" class="input-field weather-desc-select px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
            <!-- Options populated by JS -->
          </select>
        </div>
        <div>
          <label for="input-humidity" class="block text-white font-semibold mb-1 text-sm">Humidity (%)</label>
          <input type="number" id="input-humidity" class="input-field number-input-condensed px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="60" value="65">
        </div>
        <div>
          <label for="input-wind" class="block text-white font-semibold mb-1 text-sm">Wind (km/h)</label>
          <input type="number" id="input-wind" class="input-field number-input-condensed px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="10" value="25">
        </div>
        <div>
          <label for="input-precipitation" class="block text-white font-semibold mb-1 text-sm">Precip. (mm)</label>
          <input type="number" id="input-precipitation" step="0.1" class="input-field number-input-condensed px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="5.5" value="1.2">
        </div>
      </div>

      <!-- Section Title: 5-Day Forecast Input -->
      <h2 class="text-xl font-semibold text-white border-b border-white/30 pb-2 mt-6">5-Day Forecast Data</h2>
      <div id="forecast-inputs-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
        <!-- 5-day forecast input groups will be added here by JS -->
      </div>
      
      <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded-lg transition-colors w-full md:w-auto mt-6">Generate Forecast</button>
    </form>
  </div>

  <!-- Main Content Area -->
  <div class="max-w-7xl mx-auto"> 
    <!-- Warnings Section (hidden by default) -->
    <div id="warnings-section-container" class="hidden mb-6">
        <div id="active-warnings-display" class="warning-section">
            <h3 class="text-lg font-semibold mb-2 text-yellow-500">Active Weather Warnings:</h3>
            <!-- Warning items will be injected here -->
        </div>
    </div>

    <div id="weather-container" class="opacity-0 transition-opacity duration-1000 ease-in-out">
      <!-- Current Weather Section (Condensed and Re-arranged) -->
      <div class="glass p-4 md:p-6 mb-8">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
            <!-- Left Side: Location, Date -->
            <div class="mb-4 md:mb-0 md:mr-6 text-center md:text-left">
                <h2 id="location" class="text-2xl lg:text-3xl font-semibold text-white mb-1"></h2>
                <p id="date" class="text-white/80 text-sm lg:text-base"></p>
            </div>

            <!-- Middle/Right Side: Icon, Temp, Desc, H/L, Feels -->
            <div class="flex-grow flex flex-col md:flex-row items-center justify-center md:justify-end text-center md:text-left mb-4 md:mb-0">
                <div id="weather-icon-display" class="weather-icon mx-auto md:mx-0 md:mr-4 mb-2 md:mb-0"></div>
                <div class="md:ml-2">
                    <p id="weather-desc-display" class="text-white text-lg lg:text-xl"></p>
                    <h3 id="temperature-display" class="text-4xl lg:text-5xl font-bold text-white"></h3>
                    <p id="temp-high-low-display" class="text-white/90 text-sm"></p>
                    <p id="feels-like-display" class="text-white/80 text-sm"></p>
                </div>
            </div>
        </div>
        <!-- Bottom Row: Humidity, Wind, Precip -->
        <div class="mt-4 pt-4 border-t border-white/20 grid grid-cols-3 gap-2 md:gap-4 text-center">
            <div class="glass p-2 rounded">
                <p class="text-white/80 text-xs md:text-sm mb-1">Humidity</p>
                <p id="humidity-display" class="font-semibold text-white text-sm md:text-base"></p>
            </div>
            <div class="glass p-2 rounded">
                <p class="text-white/80 text-xs md:text-sm mb-1">Wind</p>
                <p id="wind-display" class="font-semibold text-white text-sm md:text-base"></p>
            </div>
            <div class="glass p-2 rounded">
                <p class="text-white/80 text-xs md:text-sm mb-1">Precip.</p>
                <p id="precipitation-display" class="font-semibold text-white text-sm md:text-base"></p>
            </div>
        </div>
      </div>
      
      <!-- 5-Day Forecast Section (Full Width Below) -->
      <div class="glass p-6">
        <h3 class="text-xl font-semibold text-white mb-4 text-center md:text-left">5-Day Forecast</h3>
        <div id="forecast-container" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2 md:gap-4"> 
          <!-- Forecast cards will be inserted here. -->
        </div>
      </div>
    </div>
  </div>

  <script>
    // --- Weather Icons ---
    const weatherIcons = {
        'Clear Sky': '<svg viewBox="0 0 64 64" class="w-full h-full"><path fill="#FFD700" d="M32 12c-11.05 0-20 8.95-20 20s8.95 20 20 20 20-8.95 20-20S43.05 12 32 12zm0 36c-8.82 0-16-7.18-16-16s7.18-16 16-16 16 7.18 16 16-7.18 16-16 16z"/><path fill="#FFD700" d="M32 4V0M32 60v-4M60 32h4M0 32h4M51.09 12.91l2.83-2.83M10.08 49.09l2.83-2.83M12.91 10.08l-2.83 2.83M49.09 51.09l-2.83 2.83" stroke="#FFD700" stroke-width="3" stroke-linecap="round"/></svg>',
        'Few Clouds': '<svg viewBox="0 0 64 64" class="w-full h-full"><path fill="#FFD700" d="M32 15.5c-7.46 0-13.5 6.04-13.5 13.5S24.54 42.5 32 42.5s13.5-6.04 13.5-13.5S39.46 15.5 32 15.5zm0 23c-5.25 0-9.5-4.25-9.5-9.5s4.25-9.5 9.5-9.5 9.5 4.25 9.5 9.5-4.25 9.5-9.5 9.5z"/><path fill="#FFF" d="M49.5 31c-.28 0-.5.22-.5.5s.22.5.5.5h5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-5zM9.5 31c-.28 0-.5.22-.5.5s.22.5.5.5h5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-5zM31.5 9c0-.28.22-.5.5-.5s.5.22.5.5v5c0 .28-.22.5-.5.5s-.5-.22-.5-.5v-5zM31.5 49c0-.28.22-.5.5-.5s.5.22.5.5v5c0 .28-.22.5-.5.5s-.5-.22-.5-.5v-5zM46.36 17.64c.2-.2.51-.2.71 0 .2.2.2.51 0 .71l-3.54 3.54c-.2.2-.51.2-.71 0s-.2-.51 0-.71l3.54-3.54zM17.64 46.36c.2-.2.51-.2.71 0 .2.2.2.51 0 .71l-3.54 3.54c-.2.2-.51.2-.71 0s-.2-.51 0-.71l3.54-3.54zM46.36 46.36c-.2-.2-.2-.51 0-.71.2-.2.51-.2.71 0l3.54 3.54c.2.2.2.51 0 .71s-.51.2-.71 0l-3.54-3.54zM17.64 17.64c-.2-.2-.2-.51 0-.71.2-.2.51-.2.71 0l3.54 3.54c.2.2.2.51 0 .71s-.51.2-.71 0l-3.54-3.54z"/><path fill="#B0C4DE" d="M45.61 20.39A12.5 12.5 0 0032 16a12.48 12.48 0 00-12.1 9.5A10.01 10.01 0 009.5 34a10 10 0 0010 10h24a8 8 0 000-16 7.92 7.92 0 00-7.89-7.61z"/></svg>',
        'Partly Cloudy': '<svg viewBox="0 0 64 64" class="w-full h-full"><path fill="#FFD700" d="M32 15.5c-7.46 0-13.5 6.04-13.5 13.5S24.54 42.5 32 42.5s13.5-6.04 13.5-13.5S39.46 15.5 32 15.5zm0 23c-5.25 0-9.5-4.25-9.5-9.5s4.25-9.5 9.5-9.5 9.5 4.25 9.5 9.5-4.25 9.5-9.5 9.5z"/><path fill="#B0C4DE" d="M50 34.5A10 10 0 0040 24.5a9.91 9.91 0 00-6.53 2.5A12.5 12.5 0 0020 16a12.48 12.48 0 00-12.1 9.5A10.01 10.01 0 009.5 34a10 10 0 0010 10h24a8 8 0 006.5-12.8z"/></svg>',
        'Scattered Clouds': '<svg viewBox="0 0 64 64" class="w-full h-full"><path fill="#B0C4DE" d="M45.61 20.39A12.5 12.5 0 0032 16a12.48 12.48 0 00-12.1 9.5A10.01 10.01 0 009.5 34a10 10 0 0010 10h24a8 8 0 000-16 7.92 7.92 0 00-7.89-7.61z"/><path fill="#A9A9A9" d="M20.5 38.5a6.5 6.5 0 000 13h18a6.5 6.5 0 000-13 6.44 6.44 0 00-6.23 4.88A8.52 8.52 0 0028 38a8.49 8.49 0 00-7.5-5.12z" opacity=".8"/></svg>',
        'Broken Clouds': '<svg viewBox="0 0 64 64" class="w-full h-full"><path fill="#A9A9A9" d="M45.61 20.39A12.5 12.5 0 0032 16a12.48 12.48 0 00-12.1 9.5A10.01 10.01 0 009.5 34a10 10 0 0010 10h24a8 8 0 000-16 7.92 7.92 0 00-7.89-7.61z"/><path fill="#808080" d="M20.5 38.5a6.5 6.5 0 000 13h18a6.5 6.5 0 000-13 6.44 6.44 0 00-6.23 4.88A8.52 8.52 0 0028 38a8.49 8.49 0 00-7.5-5.12z" opacity=".8"/></svg>',
        'Overcast': '<svg viewBox="0 0 64 64" class="w-full h-full"><path fill="#A9A9A9" d="M47.5 20A12.5 12.5 0 0035 7.5 12.5 12.5 0 0022.5 20 12.5 12.5 0 0010 32.5 12.5 12.5 0 0022.5 45h25A12.5 12.5 0 0060 32.5 12.5 12.5 0 0047.5 20zM22.5 41A8.5 8.5 0 0114 32.5 8.5 8.5 0 0122.5 24a8.5 8.5 0 018.5 8.5A8.5 8.5 0 0122.5 41zm25 0A8.5 8.5 0 0139 32.5 8.5 8.5 0 0147.5 24a8.5 8.5 0 018.5 8.5A8.5 8.5 0 0147.5 41z"/><path fill="#808080" d="M32 27.5A10 10 0 0022 37.5a10 10 0 0010 10 10 10 0 0010-10 10 10 0 00-10-10zm0 16A6 6 0 0126 37.5a6 6 0 016-6 6 6 0 016 6 6 6 0 01-6 6z" opacity=".9"/></svg>',
        'Light Rain': '<svg viewBox="0 0 64 64" class="w-full h-full"><path fill="#B0C4DE" d="M45.61 20.39A12.5 12.5 0 0032 16a12.48 12.48 0 00-12.1 9.5A10.01 10.01 0 009.5 34a10 10 0 0010 10h24a8 8 0 000-16 7.92 7.92 0 00-7.89-7.61z"/><path fill="#4682B4" d="M24 46v10M32 46v10M40 46v10" stroke="#4682B4" stroke-width="3" stroke-linecap="round"/></svg>',
        'Moderate Rain': '<svg viewBox="0 0 64 64" class="w-full h-full"><path fill="#A9A9A9" d="M45.61 20.39A12.5 12.5 0 0032 16a12.48 12.48 0 00-12.1 9.5A10.01 10.01 0 009.5 34a10 10 0 0010 10h24a8 8 0 000-16 7.92 7.92 0 00-7.89-7.61z"/><path fill="#4682B4" d="M22 45v12M32 45v12M42 45v12" stroke="#4682B4" stroke-width="4" stroke-linecap="round"/></svg>',
        'Heavy Rain': '<svg viewBox="0 0 64 64" class="w-full h-full"><path fill="#808080" d="M45.61 20.39A12.5 12.5 0 0032 16a12.48 12.48 0 00-12.1 9.5A10.01 10.01 0 009.5 34a10 10 0 0010 10h24a8 8 0 000-16 7.92 7.92 0 00-7.89-7.61z"/><path fill="#4169E1" d="M20 44v14M32 44v14M44 44v14" stroke="#4169E1" stroke-width="5" stroke-linecap="round"/></svg>',
        'Shower Rain': '<svg viewBox="0 0 64 64" class="w-full h-full"><path fill="#A9A9A9" d="M45.61 20.39A12.5 12.5 0 0032 16a12.48 12.48 0 00-12.1 9.5A10.01 10.01 0 009.5 34a10 10 0 0010 10h24a8 8 0 000-16 7.92 7.92 0 00-7.89-7.61z"/><path fill="#4682B4" d="M23 45l-2 10M32 45l-2 10M41 45l-2 10" stroke="#4682B4" stroke-width="3" stroke-linecap="round"/></svg>',
        'Thunderstorm': '<svg viewBox="0 0 64 64" class="w-full h-full"><path fill="#808080" d="M45.61 20.39A12.5 12.5 0 0032 16a12.48 12.48 0 00-12.1 9.5A10.01 10.01 0 009.5 34a10 10 0 0010 10h24a8 8 0 000-16 7.92 7.92 0 00-7.89-7.61z"/><path fill="#FFD700" d="M32 40l-6 10h5l-4 10 10-12h-5l4-8z"/></svg>',
        'Snow': '<svg viewBox="0 0 64 64" class="w-full h-full"><path fill="#B0C4DE" d="M45.61 20.39A12.5 12.5 0 0032 16a12.48 12.48 0 00-12.1 9.5A10.01 10.01 0 009.5 34a10 10 0 0010 10h24a8 8 0 000-16 7.92 7.92 0 00-7.89-7.61z"/><g fill="none" stroke="#FFF" stroke-width="3" stroke-linecap="round"><path d="M24 44v8M20 48h8M22 46l4 6M26 46l-4 6"/><path d="M32 44v8M28 48h8M30 46l4 6M34 46l-4 6"/><path d="M40 44v8M36 48h8M38 46l4 6M42 46l-4 6"/></g></svg>',
        'Mist': '<svg viewBox="0 0 64 64" class="w-full h-full"><path fill="#B0C4DE" d="M45.61 20.39A12.5 12.5 0 0032 16a12.48 12.48 0 00-12.1 9.5A10.01 10.01 0 009.5 34a10 10 0 0010 10h24a8 8 0 000-16 7.92 7.92 0 00-7.89-7.61z"/><g fill="none" stroke="#FFF" stroke-width="2.5" stroke-linecap="round"><path d="M12 45h40M15 50h34M18 55h28"/></g></svg>',
        'Default': '<svg viewBox="0 0 64 64" class="w-full h-full"><text x="32" y="40" font-size="12" text-anchor="middle" fill="#FFFFFF">N/A</text></svg>' 
    };
    const warningSVGs = {
        heat: '<svg class="warning-icon" viewBox="0 0 24 24"><path d="M12 2c-5.523 0-10 4.477-10 10s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"/><path d="M12 5c-1.103 0-2 .897-2 2v5c0 1.103.897 2 2 2s2-.897 2-2V7c0-1.103-.897-2-2-2zm0 11c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1z"/><path d="M16.243 7.757c.39-.39.39-1.024 0-1.414s-1.024-.39-1.414 0l-1.414 1.414c-.39.39-.39 1.024 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l1.414-1.414zm-8.486 0c.39-.39.39-1.024 0-1.414s-1.024-.39-1.414 0l-1.414 1.414c-.39.39-.39 1.024 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l1.414-1.414z"/></svg>',
        wind: '<svg class="warning-icon" viewBox="0 0 24 24"><path d="M19.78 11.22a.75.75 0 00-1.06-1.06L13 15.94V4.75a.75.75 0 00-1.5 0v11.19l-5.72-5.78a.75.75 0 00-1.06 1.06l7 7a.75.75 0 001.06 0l7-7zM4 18.25a.75.75 0 000 1.5h16a.75.75 0 000-1.5H4z"/><path d="M9.5 3.25a.75.75 0 01.75-.75h4a.75.75 0 010 1.5h-4a.75.75 0 01-.75-.75zm-4 4a.75.75 0 01.75-.75h11.5a.75.75 0 010 1.5H6.25a.75.75 0 01-.75-.75z"/></svg>',
        flood: '<svg class="warning-icon" viewBox="0 0 24 24"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"/><path d="M12 7c-2.757 0-5 2.243-5 5s2.243 5 5 5 5-2.243 5-5-2.243-5-5-5zm0 8c-1.654 0-3-1.346-3-3s1.346-3 3-3 3 1.346 3 3-1.346 3-3 3z"/><path d="M4.929 4.929c.39-.39.39-1.024 0-1.414s-1.024-.39-1.414 0L2.101 4.929c-.39.39-.39 1.024 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l1.414-1.414zm14.142 0c.39-.39.39-1.024 0-1.414s-1.024-.39-1.414 0l-1.414 1.414c-.39.39-.39 1.024 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l1.414-1.414z"/></svg>'
    };

    const dataFormElement = document.getElementById('data-form'); 
    const weatherContainerElement = document.getElementById('weather-container'); 
    const warningsSectionContainerElement = document.getElementById('warnings-section-container'); 
    const activeWarningsDisplayElement = document.getElementById('active-warnings-display'); 
    const weatherDescSelectElement = document.getElementById('input-weather-desc'); 
    const forecastInputsContainerElement = document.getElementById('forecast-inputs-container'); 
    const toggleFormBtnElement = document.getElementById('toggle-form-btn'); 

    function populateWeatherDescriptions(selectElement, defaultValue = "Few Clouds") {
        selectElement.innerHTML = ''; 
        for (const desc in weatherIcons) {
            if (desc !== 'Default') {
                const option = document.createElement('option');
                option.value = desc;
                option.textContent = desc;
                selectElement.appendChild(option);
            }
        }
        if (selectElement.options.length > 0) {
            let foundDefault = false;
            for(let i=0; i < selectElement.options.length; i++) {
                if(selectElement.options[i].value === defaultValue) {
                    selectElement.value = defaultValue;
                    foundDefault = true;
                    break;
                }
            }
            if (!foundDefault) selectElement.selectedIndex = 0;
        }
    }

    const daysOfWeek = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];
    const hazardOptions = [
        { value: "none", text: "None" },
        { value: "wind", text: "High Winds (Gusts >90km/h)" },
        { value: "flood", text: "Heavy Rain / Flood Risk" }
    ];

    function createForecastInputGroups() {
        forecastInputsContainerElement.innerHTML = ''; 
        for (let i = 0; i < 5; i++) {
            const dayGroup = document.createElement('div');
            dayGroup.className = 'glass p-3 rounded-lg space-y-2'; 
            let hazardSelectOptions = '';
            hazardOptions.forEach(opt => {
                hazardSelectOptions += `<option value="${opt.value}">${opt.text}</option>`;
            });

            dayGroup.innerHTML = `
                <p class="text-white font-medium text-center">Day ${i + 1}</p>
                <div class="grid grid-cols-1 gap-2"> 
                    <div>
                        <label class="block text-white text-xs mb-0.5">Day</label>
                        <input type="text" class="input-field text-input-responsive px-2 py-1 rounded text-xs forecast-day" value="${daysOfWeek[i % daysOfWeek.length]}">
                    </div>
                    <div>
                        <label class="block text-white text-xs mb-0.5">Weather</label>
                        <select class="input-field w-full px-2 py-1 rounded text-xs forecast-desc">
                        </select>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-2">
                    <div>
                        <label class="block text-white text-xs mb-0.5">Max °C</label>
                        <input type="number" class="input-field number-input-condensed px-2 py-1 rounded text-xs forecast-max-temp" value="${20 + i}">
                    </div>
                    <div>
                        <label class="block text-white text-xs mb-0.5">Min °C</label>
                        <input type="number" class="input-field number-input-condensed px-2 py-1 rounded text-xs forecast-min-temp" value="${10 + i}">
                    </div>
                </div>
                <div>
                    <label class="block text-white text-xs mb-0.5">Hazard</label>
                    <select class="input-field w-full px-2 py-1 rounded text-xs forecast-hazard">${hazardSelectOptions}</select>
                </div>
            `;
            forecastInputsContainerElement.appendChild(dayGroup);
            const descSelect = dayGroup.querySelector('.forecast-desc');
            populateWeatherDescriptions(descSelect, i % 2 === 0 ? "Clear Sky" : "Few Clouds");
            dayGroup.querySelector('.forecast-hazard').value = 'none'; 
        }
    }
    
    function checkAndDisplayWarnings(forecastData) {
        activeWarningsDisplayElement.innerHTML = '<h3 class="text-lg font-semibold mb-2 text-yellow-500">Active Weather Warnings:</h3>'; 
        let warningsFound = false;

        let consecutiveHeatDays = 0;
        for (let i = 0; i < forecastData.length; i++) {
            if (parseFloat(forecastData[i].maxTemp) >= 29 && parseFloat(forecastData[i].minTemp) >= 14) {
                consecutiveHeatDays++;
            } else {
                consecutiveHeatDays = 0; 
            }
            if (consecutiveHeatDays >= 2) {
                activeWarningsDisplayElement.innerHTML += `
                    <div class="warning-item">
                        ${warningSVGs.heat}
                        <span><strong>Heat Warning:</strong> Expected 2+ consecutive days with max temps ≥29°C & min temps ≥14°C.</span>
                    </div>`;
                warningsFound = true;
                break; 
            }
        }

        const windHazardDay = forecastData.find(day => day.hazard === 'wind');
        if (windHazardDay) {
            activeWarningsDisplayElement.innerHTML += `
                <div class="warning-item">
                    ${warningSVGs.wind}
                    <span><strong>Wind Warning:</strong> High winds (gusts >90km/h) expected on one or more days. Secure loose objects.</span>
                </div>`;
            warningsFound = true;
        }

        const floodHazardDay = forecastData.find(day => day.hazard === 'flood');
        if (floodHazardDay) {
            activeWarningsDisplayElement.innerHTML += `
                <div class="warning-item">
                    ${warningSVGs.flood}
                    <span><strong>Flood Risk / Heavy Rain:</strong> Potential for localized flooding due to heavy rain on one or more days.</span>
                </div>`;
            warningsFound = true;
        }

        if (warningsFound) {
            warningsSectionContainerElement.classList.remove('hidden');
        } else {
            warningsSectionContainerElement.classList.add('hidden');
        }
    }

    dataFormElement.addEventListener('submit', function(event) {
      event.preventDefault(); 
      const cityInput = document.getElementById('input-city').value.trim();
      const countryInput = document.getElementById('input-country').value.trim();
      const tempInput = document.getElementById('input-temp').value;
      const tempHighInput = document.getElementById('input-temp-high').value;
      const tempLowInput = document.getElementById('input-temp-low').value;
      const feelsInput = document.getElementById('input-feels').value;
      const weatherDescInput = weatherDescSelectElement.value;
      const humidityInput = document.getElementById('input-humidity').value;
      const windInput = document.getElementById('input-wind').value;
      const precipitationInput = document.getElementById('input-precipitation').value; 

      document.getElementById('location').textContent = `${cityInput}, ${countryInput}`;
      const currentDate = new Date();
      document.getElementById('date').textContent = currentDate.toLocaleDateString('en-US', {
        weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
      });
      const iconSVG = weatherIcons[weatherDescInput] || weatherIcons['Default'];
      document.getElementById('weather-icon-display').innerHTML = iconSVG;
      document.getElementById('weather-desc-display').textContent = weatherDescInput;
      document.getElementById('temperature-display').innerHTML = `${tempInput}&deg;C`;
      document.getElementById('temp-high-low-display').innerHTML = `H: ${tempHighInput}&deg; L: ${tempLowInput}&deg;`;
      document.getElementById('feels-like-display').innerHTML = `Feels like ${feelsInput}&deg;C`;
      document.getElementById('humidity-display').innerHTML = `${humidityInput}%`;
      document.getElementById('wind-display').innerHTML = `${windInput} km/h`;
      document.getElementById('precipitation-display').innerHTML = `${precipitationInput} mm`; 
      
      const forecastContainerElement = document.getElementById('forecast-container'); 
      forecastContainerElement.innerHTML = ''; 
      const fiveDayForecastData = [];
      const forecastDayInputs = document.querySelectorAll('#forecast-inputs-container > div'); 
      
      forecastDayInputs.forEach(dayGroup => {
        const day = dayGroup.querySelector('.forecast-day').value;
        const maxTemp = dayGroup.querySelector('.forecast-max-temp').value;
        const minTemp = dayGroup.querySelector('.forecast-min-temp').value;
        const description = dayGroup.querySelector('.forecast-desc').value;
        const hazard = dayGroup.querySelector('.forecast-hazard').value;
        
        fiveDayForecastData.push({ day, maxTemp, minTemp, description, hazard }); 
        
        const forecastIconSvg = weatherIcons[description] || weatherIcons['Default'];
        const hazardClass = (hazard === 'wind' || hazard === 'flood') ? 'forecast-card-hazard' : '';
        const card = `
          <div class="forecast-card glass p-3 text-center text-white h-full ${hazardClass}"> 
            <div>
              <p class="font-semibold text-sm md:text-base">${day}</p> 
              <div class="forecast-icon mx-auto my-1">${forecastIconSvg}</div> 
              <p class="text-xs">${description}</p> 
            </div>
            <p class="mt-1 text-xs md:text-sm"><span class="font-medium">${maxTemp}&deg;</span> / ${minTemp}&deg;</p> 
          </div>
        `;
        forecastContainerElement.innerHTML += card;
      });
      
      checkAndDisplayWarnings(fiveDayForecastData); 

      dataFormElement.classList.add('hidden');
      toggleFormBtnElement.textContent = 'Show Input Form';

      if (weatherContainerElement.classList.contains('opacity-0')) {
          weatherContainerElement.classList.remove('opacity-0');
          weatherContainerElement.classList.add('opacity-100');
          setTimeout(() => {
            const targetElement = warningsSectionContainerElement.classList.contains('hidden') ? weatherContainerElement : warningsSectionContainerElement;
            targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }, 100); 
      } else {
           const targetElement = warningsSectionContainerElement.classList.contains('hidden') ? weatherContainerElement : warningsSectionContainerElement;
           targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });

    toggleFormBtnElement.addEventListener('click', () => {
        dataFormElement.classList.toggle('hidden');
        if (dataFormElement.classList.contains('hidden')) {
            toggleFormBtnElement.textContent = 'Show Input Form';
        } else {
            toggleFormBtnElement.textContent = 'Hide Input Form';
            dataFormElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    });

    document.addEventListener('DOMContentLoaded', () => {
       populateWeatherDescriptions(weatherDescSelectElement, "Partly Cloudy"); 
       createForecastInputGroups(); 
       
       dataFormElement.classList.remove('hidden');
       toggleFormBtnElement.textContent = 'Hide Input Form';
       weatherContainerElement.classList.add('opacity-0');
       warningsSectionContainerElement.classList.add('hidden');
    });
  </script>
</body>
</html>
