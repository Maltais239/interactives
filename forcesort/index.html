<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forces Sorting Game Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #f0f9ff; }
        .step-card { transition: all 0.3s ease; }
        .step-card:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-6">

    <div class="max-w-4xl w-full bg-white rounded-2xl shadow-2xl overflow-hidden border border-blue-100">
        
        <!-- Header -->
        <div class="bg-gradient-to-r from-blue-600 to-blue-800 p-8 text-white text-center">
            <h1 class="text-3xl font-bold mb-2">Forces Sorting Game Builder</h1>
            <p class="opacity-90">Create your GitHub-ready game file in one step.</p>
        </div>

        <!-- Content -->
        <div class="p-8 space-y-8">

            <!-- Step 1: Upload -->
            <div class="step-card bg-blue-50 border-2 border-blue-100 rounded-xl p-6 text-center">
                <div class="w-12 h-12 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-xl font-bold mx-auto mb-4">1</div>
                <h2 class="text-xl font-bold text-gray-800 mb-2">Upload Your Images</h2>
                <p class="text-gray-600 text-sm mb-6">Select all 32 images you generated (e.g., "Applied Force - Pushing.png").</p>
                
                <label class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg cursor-pointer shadow-lg transition transform hover:scale-105">
                    <span>ðŸ“‚ Choose Images</span>
                    <input type="file" id="image-input" multiple accept="image/*" class="hidden">
                </label>
                
                <div id="status" class="mt-4 text-sm font-mono text-gray-500 hidden">
                    Loaded <span id="count" class="font-bold text-blue-600">0</span> images...
                </div>
            </div>

            <!-- Step 2: Download -->
            <div id="step-2" class="step-card bg-green-50 border-2 border-green-100 rounded-xl p-6 text-center opacity-50 pointer-events-none transition-opacity">
                <div class="w-12 h-12 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-xl font-bold mx-auto mb-4">2</div>
                <h2 class="text-xl font-bold text-gray-800 mb-2">Download Game</h2>
                <p class="text-gray-600 text-sm mb-6">Your game logic has been injected. Download the final HTML file.</p>
                
                <button id="download-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition transform hover:scale-105 flex items-center justify-center gap-2 mx-auto">
                    <span>ðŸ’¾</span> Download "index.html"
                </button>
            </div>

        </div>
        
        <!-- Footer -->
        <div class="bg-gray-50 p-4 text-center text-xs text-gray-400 border-t border-gray-100">
            Ready for GitHub Pages
        </div>

    </div>

    <script>
        const imageInput = document.getElementById('image-input');
        const statusDiv = document.getElementById('status');
        const countSpan = document.getElementById('count');
        const step2 = document.getElementById('step-2');
        const downloadBtn = document.getElementById('download-btn');

        let generatedGameHTML = "";

        // --- GAME TEMPLATE (The "Brain") ---
        const HTML_START = `<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Forces Sorting Game</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{--bg:#f0f9ff;--panel:#ffffff;--text-dark:#333333;--applied-bg:#eff6ff;--applied-border:#3b82f6;--friction-bg:#fef2f2;--friction-border:#ef4444;--tension-bg:#faf5ff;--tension-border:#a855f7;--elastic-bg:#f0fdf4;--elastic-border:#22c55e}
body{margin:0;font-family:'Poppins',sans-serif;background:var(--bg);color:var(--text-dark);display:flex;flex-direction:column;align-items:center;min-height:100vh;padding:20px}
.game-container{background:var(--panel);width:100%;max-width:1000px;padding:20px;border-radius:15px;box-shadow:0 10px 25px rgba(0,0,0,0.1)}
h1{text-align:center;color:#1e293b;margin:0 0 10px 0;font-size:1.8rem}
p.instructions{text-align:center;color:#64748b;margin-bottom:20px}
#items-pool{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;align-items:center;min-height:120px;padding:15px;background:#f8fafc;border:2px solid #e2e8f0;border-radius:12px;margin-bottom:30px}
.item{width:90px;height:90px;background:white;display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:8px;border:2px solid #cbd5e1;box-shadow:0 2px 4px rgba(0,0,0,0.05);cursor:grab;touch-action:none;user-select:none;padding:4px;transition:transform 0.2s}
.item:active{cursor:grabbing}
.item img{width:100%;height:55%;object-fit:contain;pointer-events:none;margin-bottom:4px}
.item span{font-size:0.6rem;text-align:center;line-height:1.1;font-weight:600;color:#475569;width:100%;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}
.item.dragging{opacity:0.8;position:fixed;z-index:9999;pointer-events:none;transform:scale(1.1);box-shadow:0 10px 20px rgba(0,0,0,0.2)}
.item.correct{border-color:#22c55e;background-color:#f0fdf4}
.item.incorrect{border-color:#ef4444;background-color:#fef2f2}
.zones-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
.zone-column{display:flex;flex-direction:column;gap:8px}
.zone-header{text-align:center;font-weight:bold;padding:8px;border-radius:6px;color:white;text-transform:uppercase;font-size:0.8rem;letter-spacing:0.05em}
.drop-zone{flex-grow:1;min-height:250px;border:2px dashed;border-radius:8px;padding:8px;display:flex;flex-wrap:wrap;align-content:flex-start;gap:6px;transition:background 0.2s}
.zone-applied .zone-header{background:var(--applied-border)}.zone-applied .drop-zone{border-color:var(--applied-border);background:var(--applied-bg)}
.zone-friction .zone-header{background:var(--friction-border)}.zone-friction .drop-zone{border-color:var(--friction-border);background:var(--friction-bg)}
.zone-tension .zone-header{background:var(--tension-border)}.zone-tension .drop-zone{border-color:var(--tension-border);background:var(--tension-bg)}
.zone-elastic .zone-header{background:var(--elastic-border)}.zone-elastic .drop-zone{border-color:var(--elastic-border);background:var(--elastic-bg)}
.drop-zone.over{background-color:rgba(0,0,0,0.1);border-style:solid}
.game-controls{margin-top:20px;display:flex;justify-content:center;gap:15px}
.btn{padding:10px 20px;border-radius:8px;font-weight:bold;cursor:pointer;border:none;font-family:inherit}
.btn-check{background:#3b82f6;color:white}.btn-reset{background:#e2e8f0;color:#475569}
@media (max-width:768px){.zones-grid{grid-template-columns:1fr 1fr}}@media (max-width:480px){.zones-grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="game-container">
<h1>Forces Sorting Game</h1>
<p class="instructions">Drag the examples to the correct Force category.</p>
<div id="items-pool">`;

        const HTML_END = `</div>
<div class="zones-grid">
<div class="zone-column zone-applied"><div class="zone-header">Applied Force</div><div class="drop-zone" data-category="Applied Force"></div></div>
<div class="zone-column zone-friction"><div class="zone-header">Friction</div><div class="drop-zone" data-category="Friction"></div></div>
<div class="zone-column zone-tension"><div class="zone-header">Tension</div><div class="drop-zone" data-category="Tension"></div></div>
<div class="zone-column zone-elastic"><div class="zone-header">Elastic Force</div><div class="drop-zone" data-category="Elastic Force"></div></div>
</div>
<div class="game-controls"><button class="btn btn-check" id="check-btn">Check Answers</button><button class="btn btn-reset" id="reset-btn">Reset Game</button></div>
</div>
<script>
const itemsPool=document.getElementById('items-pool');const zones=document.querySelectorAll('.drop-zone');let draggedItem=null;let ghost=null;let touchOffsets={x:0,y:0};
document.querySelectorAll('.item').forEach(item=>addDragEvents(item));
function addDragEvents(item){
item.addEventListener('dragstart',e=>{draggedItem=item;e.dataTransfer.effectAllowed='move';requestAnimationFrame(()=>item.style.opacity='0.4')});
item.addEventListener('dragend',()=>{item.style.opacity='1';draggedItem=null;zones.forEach(z=>z.classList.remove('over'))});
item.addEventListener('touchstart',handleTouchStart,{passive:false});item.addEventListener('touchmove',handleTouchMove,{passive:false});item.addEventListener('touchend',handleTouchEnd)}
zones.forEach(zone=>{zone.addEventListener('dragover',e=>{e.preventDefault();zone.classList.add('over')});zone.addEventListener('dragleave',()=>zone.classList.remove('over'));zone.addEventListener('drop',e=>{e.preventDefault();zone.classList.remove('over');if(draggedItem){draggedItem.classList.remove('correct','incorrect');zone.appendChild(draggedItem)}})});
function handleTouchStart(e){e.preventDefault();const touch=e.touches[0];const item=e.currentTarget;const rect=item.getBoundingClientRect();ghost=item.cloneNode(true);ghost.classList.add('dragging');ghost.style.width=rect.width+'px';ghost.style.height=rect.height+'px';document.body.appendChild(ghost);touchOffsets.x=touch.clientX-rect.left;touchOffsets.y=touch.clientY-rect.top;moveGhost(touch.clientX,touch.clientY)}
function handleTouchMove(e){e.preventDefault();if(!ghost)return;const touch=e.touches[0];moveGhost(touch.clientX,touch.clientY);const elem=document.elementFromPoint(touch.clientX,touch.clientY);const zone=elem?elem.closest('.drop-zone'):null;zones.forEach(z=>z.classList.remove('over'));if(zone)zone.classList.add('over')}
function handleTouchEnd(e){if(!ghost)return;const touch=e.changedTouches[0];const elem=document.elementFromPoint(touch.clientX,touch.clientY);const zone=elem?elem.closest('.drop-zone'):null;const original=e.currentTarget;if(zone){original.classList.remove('correct','incorrect');zone.appendChild(original)}ghost.remove();ghost=null;zones.forEach(z=>z.classList.remove('over'))}
function moveGhost(x,y){ghost.style.left=(x-touchOffsets.x)+'px';ghost.style.top=(y-touchOffsets.y)+'px'}
document.getElementById('check-btn').addEventListener('click',()=>{zones.forEach(zone=>{const cat=zone.dataset.category;Array.from(zone.children).forEach(item=>{if(item.dataset.category===cat){item.classList.add('correct');item.classList.remove('incorrect')}else{item.classList.add('incorrect');item.classList.remove('correct')}})})});
document.getElementById('reset-btn').addEventListener('click',()=>{const items=Array.from(document.querySelectorAll('.item'));items.sort(()=>Math.random()-0.5);items.forEach(item=>{item.classList.remove('correct','incorrect');itemsPool.appendChild(item)})});
<\/script></body></html>`;

        // --- LOGIC ---
        imageInput.addEventListener('change', async (e) => {
            const files = Array.from(e.target.files);
            if (files.length === 0) return;

            statusDiv.classList.remove('hidden');
            countSpan.innerText = "0";
            
            let itemsHTML = "";
            let processedCount = 0;

            for (const file of files) {
                // Parse name: "Applied Force - Pushing.png" -> "Applied Force" + "Pushing"
                const nameParts = file.name.replace(/\.[^/.]+$/, "").split('-');
                let category = 'Unknown';
                let term = file.name;
                
                const lowerName = file.name.toLowerCase();
                if (lowerName.includes('applied')) category = 'Applied Force';
                else if (lowerName.includes('friction')) category = 'Friction';
                else if (lowerName.includes('tension')) category = 'Tension';
                else if (lowerName.includes('elastic')) category = 'Elastic Force';

                if (nameParts.length > 1) {
                    term = nameParts[nameParts.length - 1].trim();
                }

                // Convert image to Base64
                const base64 = await new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = (evt) => resolve(evt.target.result);
                    reader.readAsDataURL(file);
                });

                itemsHTML += `<div class="item" draggable="true" id="item-${processedCount}" data-category="${category}">
    <img src="${base64}" alt="${term}">
    <span>${term}</span>
</div>\n`;
                
                processedCount++;
                countSpan.innerText = processedCount;
            }

            // Assemble Final Code
            generatedGameHTML = HTML_START + itemsHTML + HTML_END;

            // Unlock Step 2
            step2.classList.remove('opacity-50', 'pointer-events-none');
            statusDiv.innerHTML = `âœ… Success! ${processedCount} images processed.`;
        });

        downloadBtn.addEventListener('click', () => {
            const blob = new Blob([generatedGameHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'index.html'; // Defaulting to index.html for GitHub convenience
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        });

    </script>
</body>
</html>
